<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>SegTreeMut</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">haccepted-0.1.0.0: Data structures and algorithms</span><ul class="links" id="page-menu"><li><a href="src/SegTreeMut.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">SegTreeMut</p></div><div id="description"><p class="caption">Description</p><div class="doc"><h2>Mutable segment tree</h2><p>See SegTree. SegTreeMut is just that, but backed by a mutable array.
With unboxed arrays, SegTreeMut is multiple times faster than SegTree (see benchmarks).
However, this comes at the cost of purity.</p><p>Sources:</p><ul><li>Al.Cash, &quot;Efficient and easy segment trees&quot;
  <a href="https://codeforces.com/blog/entry/18051">https://codeforces.com/blog/entry/18051</a></li><li>AtCoder Library
  <a href="https://github.com/atcoder/ac-library/blob/master/atcoder/segtree.hpp">https://github.com/atcoder/ac-library/blob/master/atcoder/segtree.hpp</a></li></ul><p>Let n = r - l + 1 where (l, r) is the range of the segment tree.
The complexities assume (&lt;&gt;) takes O(1) time.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:SegTreeMut">SegTreeMut</a> marr a</li><li class="src short"><a href="#v:emptySTM">emptySTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; m (<a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a)</li><li class="src short"><a href="#v:fromListSTM">fromListSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; [a] -&gt; m (<a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a)</li><li class="src short"><a href="#v:adjustSTM">adjustSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (a -&gt; a) -&gt; m ()</li><li class="src short"><a href="#v:foldRangeSTM">foldRangeSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; m a</li><li class="src short"><a href="#v:binSearchSTM">binSearchSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; m (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, a))</li><li class="src short"><a href="#v:foldrSTM">foldrSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; m b</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SegTreeMut" class="def">SegTreeMut</a> marr a <a href="src/SegTreeMut.html#SegTreeMut" class="link">Source</a> <a href="#t:SegTreeMut" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:emptySTM" class="def">emptySTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; m (<a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a) <a href="src/SegTreeMut.html#emptySTM" class="link">Source</a> <a href="#v:emptySTM" class="selflink">#</a></p><div class="doc"><p>Builds a segment tree on (l, r) where each element is mempty. O(n).</p></div></div><div class="top"><p class="src"><a id="v:fromListSTM" class="def">fromListSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; [a] -&gt; m (<a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a) <a href="src/SegTreeMut.html#fromListSTM" class="link">Source</a> <a href="#v:fromListSTM" class="selflink">#</a></p><div class="doc"><p>Builds a segment tree on (l, r) where the elements are taken from a list. If the list is shorter
 than the range, the remaining elements are mempty. O(n).</p></div></div><div class="top"><p class="src"><a id="v:adjustSTM" class="def">adjustSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (a -&gt; a) -&gt; m () <a href="src/SegTreeMut.html#adjustSTM" class="link">Source</a> <a href="#v:adjustSTM" class="selflink">#</a></p><div class="doc"><p>Adjusts the element at index i. O(log n).</p></div></div><div class="top"><p class="src"><a id="v:foldRangeSTM" class="def">foldRangeSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; m a <a href="src/SegTreeMut.html#foldRangeSTM" class="link">Source</a> <a href="#v:foldRangeSTM" class="selflink">#</a></p><div class="doc"><p>Folds the elements in the range (ql, qr). Elements outside (l, r) are considered to be mempty.
 O(log n), or more precisely O(log(min(r, qr) - max(l, ql) + 1)).</p></div></div><div class="top"><p class="src"><a id="v:binSearchSTM" class="def">binSearchSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (a -&gt; <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; m (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Int.html#t:Int" title="Data.Int">Int</a>, a)) <a href="src/SegTreeMut.html#binSearchSTM" class="link">Source</a> <a href="#v:binSearchSTM" class="selflink">#</a></p><div class="doc"><p>Binary search in the intersection of (l, r) and (ql, qr) for the shortest prefix whose fold
 satisfies the given monotonic predicate. Returns the end index and the fold. O(log n), or more
 precisely O(log(min(r, qr) - max(l, ql) + 1)).</p></div></div><div class="top"><p class="src"><a id="v:foldrSTM" class="def">foldrSTM</a> :: (<a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a, <a href="https://hackage.haskell.org/package/array-0.5.4.0/docs/Data-Array-MArray.html#t:MArray" title="Data.Array.MArray">MArray</a> marr a m) =&gt; <a href="SegTreeMut.html#t:SegTreeMut" title="SegTreeMut">SegTreeMut</a> marr a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; m b <a href="src/SegTreeMut.html#foldrSTM" class="link">Source</a> <a href="#v:foldrSTM" class="selflink">#</a></p><div class="doc"><p>Right fold over the elements of the segment tree. O(n).</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>