<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>SuffixTree</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">haccepted-0.1.0.0: Data structures and algorithms</span><ul class="links" id="page-menu"><li><a href="src/SuffixTree.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">SuffixTree</p></div><div id="description"><p class="caption">Description</p><div class="doc"><h2>Suffix tree</h2><p>A moderately simple and flexible suffix tree.
A suffix tree of a string is a compressed trie of all the suffixes of the string, useful for fast
matching on substrings of the string or to calculate certain properties of the string.
Other suffix structures such as suffix arrays and suffix automata may serve as alternates to suffix
trees.</p><p>The implementation here constructs a SuffixTree a from a given string index function, with string
elements of type Int. Ukkonen's algorithm is used for construction. This is not lazy, the entire
tree is constructed right away.
Only the implicit suffix tree is constructed, which is a suffix tree where suffixes that are
prefixes of other suffixes do not end in leaves. To make them end in leaves, set the last element
of the string to a unique value.
A SuffixTree a also stores accumulated values of type a at every node. These values are calculated
using user supplied functions, which can be chosen based on what the tree will be used for.</p><p>Sources:</p><ul><li>Esko Ukkonen, &quot;On&#8211;line construction of suffix trees&quot;, 1995
  <a href="https://www.cs.helsinki.fi/u/ukkonen/SuffixT1withFigs.pdf">https://www.cs.helsinki.fi/u/ukkonen/SuffixT1withFigs.pdf</a></li><li>Dan Gusfield, &quot;Algorithms on Strings, Trees, and Sequences&quot;, 1997
  <a href="https://doi.org/10.1017/CBO9780511574931">https://doi.org/10.1017/CBO9780511574931</a></li></ul><p>String indexing is assumed to take O(1). Let k be the alphabet size. Let the complexity of IntMap
operations be f(n), where n is the size of the map. f(n) is O(min(n, word size)), see IntMap
documentation for details.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:SufTNode">SufTNode</a> a = <a href="#v:SufTNode">SufTNode</a> !a !(<a href="../containers-0.6.2.1/Data-IntMap-Strict-Internal.html#t:IntMap" title="Data.IntMap.Strict.Internal">IntMap</a> (<a href="SuffixTree.html#t:SufTEdge" title="SuffixTree">SufTEdge</a> a))</li><li class="src short"><span class="keyword">data</span> <a href="#t:SufTEdge">SufTEdge</a> a = <a href="#v:SufTEdge">SufTEdge</a> !<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> !<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> !(<a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a)</li><li class="src short"><a href="#v:buildSufT">buildSufT</a> :: (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a</li><li class="src short"><a href="#v:matchSufT">matchSufT</a> :: (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a</li><li class="src short"><a href="#v:buildMatchSufT">buildMatchSufT</a> :: (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a</li><li class="src short"><a href="#v:drawSufT">drawSufT</a> :: <a href="../base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a =&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a -&gt; <a href="../base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SufTNode" class="def">SufTNode</a> a <a href="src/SuffixTree.html#SufTNode" class="link">Source</a> <a href="#t:SufTNode" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SufTNode" class="def">SufTNode</a> !a !(<a href="../containers-0.6.2.1/Data-IntMap-Strict-Internal.html#t:IntMap" title="Data.IntMap.Strict.Internal">IntMap</a> (<a href="SuffixTree.html#t:SufTEdge" title="SuffixTree">SufTEdge</a> a))</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SufTNode">Instances</h4><details id="i:SufTNode" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SufTNode:NFData:1"></span> <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> a =&gt; <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> (<a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a)</span> <a href="src/SuffixTree.html#line-168" class="link">Source</a> <a href="#t:SufTNode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SufTNode:NFData:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="SuffixTree.html">SuffixTree</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SufTEdge" class="def">SufTEdge</a> a <a href="src/SuffixTree.html#SufTEdge" class="link">Source</a> <a href="#t:SufTEdge" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SufTEdge" class="def">SufTEdge</a> !<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> !<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> !(<a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SufTEdge">Instances</h4><details id="i:SufTEdge" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SufTEdge:NFData:1"></span> <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> a =&gt; <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> (<a href="SuffixTree.html#t:SufTEdge" title="SuffixTree">SufTEdge</a> a)</span> <a href="src/SuffixTree.html#line-165" class="link">Source</a> <a href="#t:SufTEdge" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SufTEdge:NFData:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="SuffixTree.html">SuffixTree</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="SuffixTree.html#t:SufTEdge" title="SuffixTree">SufTEdge</a> a -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:buildSufT" class="def">buildSufT</a> :: (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a <a href="src/SuffixTree.html#buildSufT" class="link">Source</a> <a href="#v:buildSufT" class="selflink">#</a></p><div class="doc"><p>Builds a suffix tree. n is the length of the string. at is a 0-based indexing function into the
 string. fromLeaf constructs a value from a leaf index. updEdge constructs a value from an existing
 value and a length of an edge leading to it. merge combines two values.
 Examples:
   To query the number of times a pattern occurs in the string, use const 1, const, and (+).
   To calculate the number of distinct substrings, use const 0, (+), and (+).
 O(n * f(k)), plus the above functions are each called O(n) times.</p></div></div><div class="top"><p class="src"><a id="v:matchSufT" class="def">matchSufT</a> :: (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a <a href="src/SuffixTree.html#matchSufT" class="link">Source</a> <a href="#v:matchSufT" class="selflink">#</a></p><div class="doc"><p>Matches a pattern on the suffix tree. updEdge and at are as defined for buildSufT. m is the length
 of the pattern. at' is a 0-based indexing function into the pattern. If the pattern is not present,
 returns Nothing. Otherwise returns the accumulated value for the subtree where the pattern ends.
 O(m * f(k)) plus at most one call of updEdge.</p></div></div><div class="top"><p class="src"><a id="v:buildMatchSufT" class="def">buildMatchSufT</a> :: (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; Chr) -&gt; <a href="../base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a <a href="src/SuffixTree.html#buildMatchSufT" class="link">Source</a> <a href="#v:buildMatchSufT" class="selflink">#</a></p><div class="doc"><p>buildSufT together with matchSufT to avoid having to repeat arguments. Apply partially for
 multiple queries.</p></div></div><div class="top"><p class="src"><a id="v:drawSufT" class="def">drawSufT</a> :: <a href="../base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a =&gt; <a href="SuffixTree.html#t:SufTNode" title="SuffixTree">SufTNode</a> a -&gt; <a href="../base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="src/SuffixTree.html#drawSufT" class="link">Source</a> <a href="#v:drawSufT" class="selflink">#</a></p><div class="doc"><p>Draws a suffix tree. Can be used for debugging.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>