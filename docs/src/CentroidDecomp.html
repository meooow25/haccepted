<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
== Centroid decomposition

A recursive decomposition (divide-and-conquer) of a tree into multiple subtrees.
This allows performing certain operations involving paths on the original tree effectively, by
taking every path on the tree into account exactly once when it passes through the root of a
decomposed subtree. The roots of the subtrees are chosen to be centroids so that the recursive
decomposition has logarithmic depth.

Sources:

* https://petr-mitrichev.blogspot.com/2015/03/this-week-in-competitive-programming_22.html
* https://github.com/cheran-senthil/PyRival/blob/master/pyrival/graphs/centroid_decomposition.py

-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">{-
Implementation notes:
* The decomposition is done in the usual manner by rerooting the tree at its centroid, then
  recursively decomposing its subtrees.
* Yes, centroidDecompose and centroidDecomposeL are very similar but pulling out the common parts
  makes it messy, so they remain different functions.
-}</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CentroidDecomp</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="CentroidDecomp.html#centroidDecompose"><span class="hs-identifier">centroidDecompose</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="CentroidDecomp.html#centroidDecomposeL"><span class="hs-identifier">centroidDecomposeL</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="LabelledGraph.html"><span class="hs-identifier">LabelledGraph</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="LabelledGraph.html#LTree"><span class="hs-identifier">LTree</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LabelledGraph.html#lTreeToTree"><span class="hs-identifier">lTreeToTree</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Misc.html"><span class="hs-identifier">Misc</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Misc.html#farthest"><span class="hs-identifier">farthest</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Performs centroid decomposition on a tree of n nodes, returning the decomposition as a tree of</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- n trees. O(n log n).</span><span>
</span><span id="line-37"></span><span id="local-6989586621679068789"><span class="annot"><a href="CentroidDecomp.html#centroidDecompose"><span class="hs-identifier hs-type">centroidDecompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679068789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679068789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-38"></span><span id="centroidDecompose"><span class="annot"><span class="annottext">centroidDecompose :: Tree a -&gt; Tree (Tree a)
</span><a href="CentroidDecomp.html#centroidDecompose"><span class="hs-identifier hs-var hs-var">centroidDecompose</span></a></span></span><span> </span><span id="local-6989586621679068788"><span class="annot"><span class="annottext">Tree a
</span><a href="#local-6989586621679068788"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Tree Int -&gt; Tree (Tree a)
forall a a. (Ord a, Num a) =&gt; Tree a -&gt; Tree a -&gt; Tree (Tree a)
</span><a href="#local-6989586621679068787"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a
</span><a href="#local-6989586621679068788"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [Tree Int] -&gt; Tree Int) -&gt; Tree a -&gt; Tree Int
forall a b. (a -&gt; [b] -&gt; b) -&gt; Tree a -&gt; b
</span><span class="hs-identifier hs-var">foldTree</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Tree Int] -&gt; Tree Int
forall p. p -&gt; [Tree Int] -&gt; Tree Int
</span><a href="#local-6989586621679068785"><span class="hs-identifier hs-var">szf</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a
</span><a href="#local-6989586621679068788"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679068785"><span class="annot"><span class="annottext">szf :: p -&gt; [Tree Int] -&gt; Tree Int
</span><a href="#local-6989586621679068785"><span class="hs-identifier hs-var hs-var">szf</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679068784"><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068784"><span class="hs-identifier hs-var">szts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068783"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679068783"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tree Int -&gt; Int) -&gt; [Tree Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tree Int -&gt; Int
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var hs-var">rootLabel</span></span><span> </span><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068784"><span class="hs-identifier hs-var">szts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068783"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Tree Int -&gt; Tree Int
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Tree Int] -&gt; Tree Int
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068783"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068784"><span class="hs-identifier hs-var">szts</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679068787"><span class="annot"><span class="annottext">go :: Tree a -&gt; Tree a -&gt; Tree (Tree a)
</span><a href="#local-6989586621679068787"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068778"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068778"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679068777"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068777"><span class="hs-identifier hs-var">rts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068776"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068776"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679068775"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068775"><span class="hs-identifier hs-var">rszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((a, Forest a, Forest a) -&gt; Maybe (a, Forest a, Forest a))
-&gt; (a, Forest a, Forest a) -&gt; (a, Forest a, Forest a)
forall a. (a -&gt; Maybe a) -&gt; a -&gt; a
</span><a href="Misc.html#farthest"><span class="hs-identifier hs-var">farthest</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Forest a, Forest a) -&gt; Maybe (a, Forest a, Forest a)
forall a. (a, [Tree a], Forest a) -&gt; Maybe (a, [Tree a], Forest a)
</span><a href="#local-6989586621679068774"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068778"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068777"><span class="hs-identifier hs-var">rts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068775"><span class="hs-identifier hs-var">rszts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-41"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679068773"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068773"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068772"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068772"><span class="hs-identifier hs-var">uts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068771"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068771"><span class="hs-identifier hs-var">uszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Forest (Tree a) -&gt; Tree (Tree a)
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Tree a
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068773"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068772"><span class="hs-identifier hs-var">uts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tree a -&gt; Tree a -&gt; Tree (Tree a))
-&gt; Forest a -&gt; Forest a -&gt; Forest (Tree a)
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Tree a -&gt; Tree (Tree a)
</span><a href="#local-6989586621679068787"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068772"><span class="hs-identifier hs-var">uts</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068771"><span class="hs-identifier hs-var">uszts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>        </span><span id="local-6989586621679068774"><span class="annot"><span class="annottext">step :: (a, [Tree a], Forest a) -&gt; Maybe (a, [Tree a], Forest a)
</span><a href="#local-6989586621679068774"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068769"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068769"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068768"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068768"><span class="hs-identifier hs-var">uts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068767"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068767"><span class="hs-identifier hs-var">uszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tree a, Tree a, [Tree a], Forest a) -&gt; (a, [Tree a], Forest a)
</span><a href="#local-6989586621679068766"><span class="hs-identifier hs-var">mkv</span></a></span><span> </span><span class="annot"><span class="annottext">((Tree a, Tree a, [Tree a], Forest a) -&gt; (a, [Tree a], Forest a))
-&gt; Maybe (Tree a, Tree a, [Tree a], Forest a)
-&gt; Maybe (a, [Tree a], Forest a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Tree a -&gt; Bool)
-&gt; [Tree a]
-&gt; Forest a
-&gt; Maybe (Tree a, Tree a, [Tree a], Forest a)
forall b a. (b -&gt; Bool) -&gt; [a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="CentroidDecomp.html#removeOne"><span class="hs-identifier hs-var">removeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068776"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (Tree a -&gt; a) -&gt; Tree a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Tree a -&gt; a) -&gt; Tree a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; a
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var hs-var">rootLabel</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068768"><span class="hs-identifier hs-var">uts</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068767"><span class="hs-identifier hs-var">uszts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>            </span><span id="local-6989586621679068766"><span class="annot"><span class="annottext">mkv :: (Tree a, Tree a, [Tree a], Forest a) -&gt; (a, [Tree a], Forest a)
</span><a href="#local-6989586621679068766"><span class="hs-identifier hs-var hs-var">mkv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068760"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068760"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679068759"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068759"><span class="hs-identifier hs-var">vts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068758"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068758"><span class="hs-identifier hs-var">vsz</span></a></span></span><span> </span><span id="local-6989586621679068757"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068757"><span class="hs-identifier hs-var">vszts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068756"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068756"><span class="hs-identifier hs-var">uts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068755"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068755"><span class="hs-identifier hs-var">uszts'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068760"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068754"><span class="hs-identifier hs-var">vts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068753"><span class="hs-identifier hs-var">vszts'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>                </span><span id="local-6989586621679068754"><span class="annot"><span class="annottext">vts' :: [Tree a]
</span><a href="#local-6989586621679068754"><span class="hs-identifier hs-var hs-var">vts'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Tree a] -&gt; Tree a
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068769"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068756"><span class="hs-identifier hs-var">uts'</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; [Tree a] -&gt; [Tree a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679068759"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-46"></span><span>                </span><span id="local-6989586621679068753"><span class="annot"><span class="annottext">vszts' :: Forest a
</span><a href="#local-6989586621679068753"><span class="hs-identifier hs-var hs-var">vszts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068752"><span class="annot"><span class="annottext">usz' :: a
</span><a href="#local-6989586621679068752"><span class="hs-identifier hs-var hs-var">usz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068776"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068758"><span class="hs-identifier hs-var">vsz</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068752"><span class="hs-identifier hs-var">usz'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Forest a
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Tree a
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068752"><span class="hs-identifier hs-var">usz'</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068755"><span class="hs-identifier hs-var">uszts'</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Forest a -&gt; Forest a
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068757"><span class="hs-identifier hs-var">vszts</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | Same as centroidDecompose, for edge-labelled graphs. O(n log n).</span><span>
</span><span id="line-49"></span><span id="local-6989586621679068750"><span id="local-6989586621679068751"><span class="annot"><a href="CentroidDecomp.html#centroidDecomposeL"><span class="hs-identifier hs-type">centroidDecomposeL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LabelledGraph.html#LTree"><span class="hs-identifier hs-type">LTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068751"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="LabelledGraph.html#LTree"><span class="hs-identifier hs-type">LTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068751"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068750"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-50"></span><span id="centroidDecomposeL"><span class="annot"><span class="annottext">centroidDecomposeL :: LTree b a -&gt; Tree (LTree b a)
</span><a href="CentroidDecomp.html#centroidDecomposeL"><span class="hs-identifier hs-var hs-var">centroidDecomposeL</span></a></span></span><span> </span><span id="local-6989586621679068749"><span class="annot"><span class="annottext">LTree b a
</span><a href="#local-6989586621679068749"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LTree b a -&gt; Tree Int -&gt; Tree (LTree b a)
forall a a a.
(Ord a, Num a) =&gt;
LTree a a -&gt; Tree a -&gt; Tree (LTree a a)
</span><a href="#local-6989586621679068748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LTree b a
</span><a href="#local-6989586621679068749"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [Tree Int] -&gt; Tree Int) -&gt; Tree a -&gt; Tree Int
forall a b. (a -&gt; [b] -&gt; b) -&gt; Tree a -&gt; b
</span><span class="hs-identifier hs-var">foldTree</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Tree Int] -&gt; Tree Int
forall p. p -&gt; [Tree Int] -&gt; Tree Int
</span><a href="#local-6989586621679068747"><span class="hs-identifier hs-var">szf</span></a></span><span> </span><span class="annot"><span class="annottext">(Tree a -&gt; Tree Int) -&gt; Tree a -&gt; Tree Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LTree b a -&gt; Tree a
forall b a. LTree b a -&gt; Tree a
</span><a href="LabelledGraph.html#lTreeToTree"><span class="hs-identifier hs-var">lTreeToTree</span></a></span><span> </span><span class="annot"><span class="annottext">LTree b a
</span><a href="#local-6989586621679068749"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679068747"><span class="annot"><span class="annottext">szf :: p -&gt; [Tree Int] -&gt; Tree Int
</span><a href="#local-6989586621679068747"><span class="hs-identifier hs-var hs-var">szf</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679068746"><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068746"><span class="hs-identifier hs-var">szts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068745"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679068745"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tree Int -&gt; Int) -&gt; [Tree Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tree Int -&gt; Int
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var hs-var">rootLabel</span></span><span> </span><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068746"><span class="hs-identifier hs-var">szts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068745"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Tree Int -&gt; Tree Int
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Tree Int] -&gt; Tree Int
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068745"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree Int]
</span><a href="#local-6989586621679068746"><span class="hs-identifier hs-var">szts</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621679068748"><span class="annot"><span class="annottext">go :: LTree a a -&gt; Tree a -&gt; Tree (LTree a a)
</span><a href="#local-6989586621679068748"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="LabelledGraph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span id="local-6989586621679068743"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068743"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679068742"><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068742"><span class="hs-identifier hs-var">rts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068741"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679068740"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068740"><span class="hs-identifier hs-var">rszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((a, [(a, LTree a a)], Forest a)
 -&gt; Maybe (a, [(a, LTree a a)], Forest a))
-&gt; (a, [(a, LTree a a)], Forest a)
-&gt; (a, [(a, LTree a a)], Forest a)
forall a. (a -&gt; Maybe a) -&gt; a -&gt; a
</span><a href="Misc.html#farthest"><span class="hs-identifier hs-var">farthest</span></a></span><span> </span><span class="annot"><span class="annottext">(a, [(a, LTree a a)], Forest a)
-&gt; Maybe (a, [(a, LTree a a)], Forest a)
forall a a.
(a, [(a, LTree a a)], Forest a)
-&gt; Maybe (a, [(a, LTree a a)], Forest a)
</span><a href="#local-6989586621679068739"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068743"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068742"><span class="hs-identifier hs-var">rts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068740"><span class="hs-identifier hs-var">rszts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679068738"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068738"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068737"><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068737"><span class="hs-identifier hs-var">uts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068736"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068736"><span class="hs-identifier hs-var">uszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LTree a a -&gt; Forest (LTree a a) -&gt; Tree (LTree a a)
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [(a, LTree a a)] -&gt; LTree a a
forall b a. a -&gt; [(b, LTree b a)] -&gt; LTree b a
</span><a href="LabelledGraph.html#LNode"><span class="hs-identifier hs-var">LNode</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068738"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068737"><span class="hs-identifier hs-var">uts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, LTree a a) -&gt; Tree a -&gt; Tree (LTree a a))
-&gt; [(a, LTree a a)] -&gt; Forest a -&gt; Forest (LTree a a)
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LTree a a -&gt; Tree a -&gt; Tree (LTree a a)
</span><a href="#local-6989586621679068748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(LTree a a -&gt; Tree a -&gt; Tree (LTree a a))
-&gt; ((a, LTree a a) -&gt; LTree a a)
-&gt; (a, LTree a a)
-&gt; Tree a
-&gt; Tree (LTree a a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, LTree a a) -&gt; LTree a a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068737"><span class="hs-identifier hs-var">uts</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068736"><span class="hs-identifier hs-var">uszts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>        </span><span id="local-6989586621679068739"><span class="annot"><span class="annottext">step :: (a, [(a, LTree a a)], Forest a)
-&gt; Maybe (a, [(a, LTree a a)], Forest a)
</span><a href="#local-6989586621679068739"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068735"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068735"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068734"><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068734"><span class="hs-identifier hs-var">uts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068733"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068733"><span class="hs-identifier hs-var">uszts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
-&gt; (a, [(a, LTree a a)], Forest a)
forall a.
((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
-&gt; (a, [(a, LTree a a)], Forest a)
</span><a href="#local-6989586621679068732"><span class="hs-identifier hs-var">mkv</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
 -&gt; (a, [(a, LTree a a)], Forest a))
-&gt; Maybe ((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
-&gt; Maybe (a, [(a, LTree a a)], Forest a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Tree a -&gt; Bool)
-&gt; [(a, LTree a a)]
-&gt; Forest a
-&gt; Maybe ((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
forall b a. (b -&gt; Bool) -&gt; [a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="CentroidDecomp.html#removeOne"><span class="hs-identifier hs-var">removeOne</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068741"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (Tree a -&gt; a) -&gt; Tree a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Tree a -&gt; a) -&gt; Tree a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; a
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var hs-var">rootLabel</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068734"><span class="hs-identifier hs-var">uts</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068733"><span class="hs-identifier hs-var">uszts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>            </span><span id="local-6989586621679068732"><span class="annot"><span class="annottext">mkv :: ((a, LTree a a), Tree a, [(a, LTree a a)], Forest a)
-&gt; (a, [(a, LTree a a)], Forest a)
</span><a href="#local-6989586621679068732"><span class="hs-identifier hs-var hs-var">mkv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679068731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068731"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LabelledGraph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span id="local-6989586621679068730"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068730"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679068729"><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068729"><span class="hs-identifier hs-var">vts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679068728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068728"><span class="hs-identifier hs-var">vsz</span></a></span></span><span> </span><span id="local-6989586621679068727"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068727"><span class="hs-identifier hs-var">vszts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068726"><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068726"><span class="hs-identifier hs-var">uts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068725"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068725"><span class="hs-identifier hs-var">uszts'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068730"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068724"><span class="hs-identifier hs-var">vts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068723"><span class="hs-identifier hs-var">vszts'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>                </span><span id="local-6989586621679068724"><span class="annot"><span class="annottext">vts' :: [(a, LTree a a)]
</span><a href="#local-6989586621679068724"><span class="hs-identifier hs-var hs-var">vts'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068731"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; [(a, LTree a a)] -&gt; LTree a a
forall b a. a -&gt; [(b, LTree b a)] -&gt; LTree b a
</span><a href="LabelledGraph.html#LNode"><span class="hs-identifier hs-var">LNode</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068735"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068726"><span class="hs-identifier hs-var">uts'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, LTree a a) -&gt; [(a, LTree a a)] -&gt; [(a, LTree a a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, LTree a a)]
</span><a href="#local-6989586621679068729"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-58"></span><span>                </span><span id="local-6989586621679068723"><span class="annot"><span class="annottext">vszts' :: Forest a
</span><a href="#local-6989586621679068723"><span class="hs-identifier hs-var hs-var">vszts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068722"><span class="annot"><span class="annottext">usz' :: a
</span><a href="#local-6989586621679068722"><span class="hs-identifier hs-var hs-var">usz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068741"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068728"><span class="hs-identifier hs-var">vsz</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068722"><span class="hs-identifier hs-var">usz'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Forest a
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Tree a
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068722"><span class="hs-identifier hs-var">usz'</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068725"><span class="hs-identifier hs-var">uszts'</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Forest a -&gt; Forest a
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679068727"><span class="hs-identifier hs-var">vszts</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span id="local-6989586621679068823"><span id="local-6989586621679068824"><span class="annot"><a href="CentroidDecomp.html#removeOne"><span class="hs-identifier hs-type">removeOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068824"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068823"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068824"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068823"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679068824"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068823"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068824"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-61"></span><span id="removeOne"><span class="annot"><span class="annottext">removeOne :: (b -&gt; Bool) -&gt; [a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="CentroidDecomp.html#removeOne"><span class="hs-identifier hs-var hs-var">removeOne</span></a></span></span><span> </span><span id="local-6989586621679068721"><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679068721"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
forall a. [a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="#local-6989586621679068720"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679068720"><span class="annot"><span class="annottext">go :: [a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="#local-6989586621679068720"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, [a], [b])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="#local-6989586621679068720"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068719"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679068718"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068718"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068717"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068717"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679068716"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679068716"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679068721"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068717"><span class="hs-identifier hs-var">b</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, [a], [b]) -&gt; Maybe (a, b, [a], [b])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068719"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068717"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068718"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679068716"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679068715"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068715"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068714"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068714"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068713"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068713"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068712"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679068712"><span class="hs-identifier hs-var">bs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068715"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068714"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679068719"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068713"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068717"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679068712"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a, b, [a], [b]) -&gt; (a, b, [a], [b]))
-&gt; Maybe (a, b, [a], [b]) -&gt; Maybe (a, b, [a], [b])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b] -&gt; Maybe (a, b, [a], [b])
</span><a href="#local-6989586621679068720"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068718"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679068716"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="#local-6989586621679068720"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe (a, b, [a], [b])
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bad input&quot;</span></span><span>
</span><span id="line-67"></span></pre></body></html>