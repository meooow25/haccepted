<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
== PQ-tree

PQ-tree is a data structure for representing permutations. It's useful for solving the consecutive
ones problem.

This is an implementation of PQ-tree as described by Booth and Lueker. The tree consists of three
types of nodes, P, Q and leaf. Leaves are single elements. The frontier of the tree is the left to
right order of leaves in the tree. A P-node is equivalent to another with its children permuted in
any order. A Q-node is equivalent to one with its children reversed. The permutations represented by
a tree are the frontiers of all equivalent trees.

The various reduction templates described in Booth and Lueker's paper are used, but the construction
algorithm is not. This implementation is purely functional, hence it uses a simpler top-down
approach instead that runs in O(n) time (plus set member check overheads) rather than in
O(update size).
This implementation is specialized to Ints, but can be modified to work with other types.

Sources:

* https://en.wikipedia.org/wiki/PQ_tree
* Kellogg S. Booth and George S. Lueker, &quot;Testing for the consecutive ones property, interval
  graphs, and graph planarity using PQ-tree algorithms&quot;, 1976
  https://www.sciencedirect.com/science/article/pii/S0022000076800451

-}</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">{-
Implementation notes:
* In reduce, the root of the pertinent subtree is found using pertinent node counts, then another
  pass is made through the pertinent subtree performing the actual reduction.
* The RNode type is a temporary node indicating empty, full, or partial status. In a reduction that
  does not reduce the tree to Nothing, there are at most two partial RNodes that float up to the
  root of the pertinent subtree.
-}</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PQTree</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier">PQNode</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#buildPQ"><span class="hs-identifier">buildPQ</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#reducePQ"><span class="hs-identifier">reducePQ</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#reduceAllPQ"><span class="hs-identifier">reduceAllPQ</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#frontierPQ"><span class="hs-identifier">frontierPQ</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#permsPQ"><span class="hs-identifier">permsPQ</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">data</span><span> </span><span id="PQNode"><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-var">PQNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PQLeaf"><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-var">PQLeaf</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-56"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="PNode"><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-var">PNode</span></a></span></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="QNode"><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-var">QNode</span></a></span></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>            </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679072747"><span id="local-6989586621679072749"><span id="local-6989586621679072751"><span class="annot"><span class="annottext">Int -&gt; PQNode -&gt; ShowS
[PQNode] -&gt; ShowS
PQNode -&gt; String
(Int -&gt; PQNode -&gt; ShowS)
-&gt; (PQNode -&gt; String) -&gt; ([PQNode] -&gt; ShowS) -&gt; Show PQNode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PQNode] -&gt; ShowS
$cshowList :: [PQNode] -&gt; ShowS
show :: PQNode -&gt; String
$cshow :: PQNode -&gt; String
showsPrec :: Int -&gt; PQNode -&gt; ShowS
$cshowsPrec :: Int -&gt; PQNode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">type</span><span> </span><span id="Parts"><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-var">Parts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- empty and full, end first</span><span>
</span><span id="line-61"></span><span class="hs-keyword">data</span><span> </span><span id="RNode"><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-var">RNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Empty"><span class="annot"><a href="PQTree.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-62"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="Full"><span class="annot"><a href="PQTree.html#Full"><span class="hs-identifier hs-var">Full</span></a></span></span><span>  </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-63"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="Part"><span class="annot"><a href="PQTree.html#Part"><span class="hs-identifier hs-var">Part</span></a></span></span><span>  </span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span>
</span><span id="line-64"></span><span>           </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679072737"><span id="local-6989586621679072739"><span id="local-6989586621679072741"><span class="annot"><span class="annottext">Int -&gt; RNode -&gt; ShowS
[RNode] -&gt; ShowS
RNode -&gt; String
(Int -&gt; RNode -&gt; ShowS)
-&gt; (RNode -&gt; String) -&gt; ([RNode] -&gt; ShowS) -&gt; Show RNode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RNode] -&gt; ShowS
$cshowList :: [RNode] -&gt; ShowS
show :: RNode -&gt; String
$cshow :: RNode -&gt; String
showsPrec :: Int -&gt; RNode -&gt; ShowS
$cshowsPrec :: Int -&gt; RNode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-type">mkPNode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-type">mkQNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-67"></span><span id="mkPNode"><span class="annot"><span class="annottext">mkPNode :: [PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var hs-var">mkPNode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PQNode
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty PNode&quot;</span></span><span>
</span><span id="line-68"></span><span class="annot"><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679072733"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072733"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072733"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span id="local-6989586621679072732"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072732"><span class="hs-identifier hs-var">ns</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#PNode"><span class="hs-identifier hs-var">PNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072732"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-70"></span><span id="mkQNode"><span class="annot"><span class="annottext">mkQNode :: [PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var hs-var">mkQNode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PQNode
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty QNode&quot;</span></span><span>
</span><span id="line-71"></span><span class="annot"><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var">mkQNode</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679072731"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072731"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072731"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-72"></span><span class="annot"><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var">mkQNode</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679072730"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072730"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072729"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072729"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#PNode"><span class="hs-identifier hs-var">PNode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072730"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072729"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span class="annot"><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var">mkQNode</span></a></span><span> </span><span id="local-6989586621679072728"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072728"><span class="hs-identifier hs-var">ns</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#QNode"><span class="hs-identifier hs-var">QNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072728"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-type">mkPartial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span>
</span><span id="line-76"></span><span id="mkPartial"><span class="annot"><span class="annottext">mkPartial :: [PQNode] -&gt; [PQNode] -&gt; RNode
</span><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var hs-var">mkPartial</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RNode
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty RNode es&quot;</span></span><span>
</span><span id="line-77"></span><span class="annot"><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RNode
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty RNode fs&quot;</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span> </span><span id="local-6989586621679072726"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072726"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679072725"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072725"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parts -&gt; RNode
</span><a href="PQTree.html#Part"><span class="hs-identifier hs-var">Part</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072726"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072725"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><a href="PQTree.html#emptyMany"><span class="hs-identifier hs-type">emptyMany</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PQTree.html#fullMany"><span class="hs-identifier hs-type">fullMany</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span id="emptyMany"><span class="annot"><span class="annottext">emptyMany :: State [RNode] [PQNode]
</span><a href="PQTree.html#emptyMany"><span class="hs-identifier hs-var hs-var">emptyMany</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">(([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode])
-&gt; ([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072721"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679072721"><span class="annot"><span class="annottext">go :: [PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072721"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679072720"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072720"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span id="local-6989586621679072719"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072719"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679072718"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072718"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072721"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072719"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072720"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072718"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="#local-6989586621679072721"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679072717"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072717"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span id="local-6989586621679072716"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072716"><span class="hs-identifier hs-var">xs</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072717"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072716"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="fullMany"><span class="annot"><span class="annottext">fullMany :: State [RNode] [PQNode]
</span><a href="PQTree.html#fullMany"><span class="hs-identifier hs-var hs-var">fullMany</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">(([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode])
-&gt; ([RNode] -&gt; ([PQNode], [RNode])) -&gt; State [RNode] [PQNode]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072714"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679072714"><span class="annot"><span class="annottext">go :: [PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072714"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679072713"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072713"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#Full"><span class="hs-identifier hs-type">Full</span></a></span><span> </span><span id="local-6989586621679072712"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072712"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679072711"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072711"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [RNode] -&gt; ([PQNode], [RNode])
</span><a href="#local-6989586621679072714"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072712"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072713"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072711"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679072714"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679072710"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072710"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span id="local-6989586621679072709"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072709"><span class="hs-identifier hs-var">xs</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072710"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072709"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="PQTree.html#partialMaybe"><span class="hs-identifier hs-type">partialMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span id="partialMaybe"><span class="annot"><span class="annottext">partialMaybe :: State [RNode] (Maybe Parts)
</span><a href="PQTree.html#partialMaybe"><span class="hs-identifier hs-var hs-var">partialMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; (Maybe Parts, [RNode])) -&gt; State [RNode] (Maybe Parts)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; (Maybe Parts, [RNode])
</span><a href="#local-6989586621679072707"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679072707"><span class="annot"><span class="annottext">go :: [RNode] -&gt; (Maybe Parts, [RNode])
</span><a href="#local-6989586621679072707"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span> </span><span id="local-6989586621679072706"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072706"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679072705"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072705"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parts -&gt; Maybe Parts
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072706"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072705"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621679072707"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679072704"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072704"><span class="hs-identifier hs-var">xs</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Parts
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072704"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="PQTree.html#splitForP"><span class="hs-identifier hs-type">splitForP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span id="splitForP"><span class="annot"><span class="annottext">splitForP :: [RNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="PQTree.html#splitForP"><span class="hs-identifier hs-var hs-var">splitForP</span></a></span></span><span> </span><span id="local-6989586621679072702"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072702"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RNode]
-&gt; [PQNode] -&gt; [Parts] -&gt; [PQNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="#local-6989586621679072701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072702"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679072701"><span class="annot"><span class="annottext">go :: [RNode]
-&gt; [PQNode] -&gt; [Parts] -&gt; [PQNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="#local-6989586621679072701"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679072700"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072700"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679072699"><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072699"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679072698"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072698"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072700"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072699"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072698"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="#local-6989586621679072701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072697"><span class="annot"><span class="annottext">RNode
</span><a href="#local-6989586621679072697"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679072696"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072696"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679072695"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072695"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679072694"><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072694"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679072693"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072693"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RNode
</span><a href="#local-6989586621679072697"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="PQTree.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span id="local-6989586621679072692"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072692"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RNode]
-&gt; [PQNode] -&gt; [Parts] -&gt; [PQNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="#local-6989586621679072701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072696"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072692"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072695"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072694"><span class="hs-identifier hs-var">ps</span></a></span><span>     </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072693"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="PQTree.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span> </span><span id="local-6989586621679072691"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072691"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RNode]
-&gt; [PQNode] -&gt; [Parts] -&gt; [PQNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="#local-6989586621679072701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072696"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072695"><span class="hs-identifier hs-var">es</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072691"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Parts -&gt; [Parts] -&gt; [Parts]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072694"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072693"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="PQTree.html#Full"><span class="hs-identifier hs-type">Full</span></a></span><span> </span><span id="local-6989586621679072690"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072690"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RNode]
-&gt; [PQNode] -&gt; [Parts] -&gt; [PQNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="#local-6989586621679072701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072696"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072695"><span class="hs-identifier hs-var">es</span></a></span><span>     </span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072694"><span class="hs-identifier hs-var">ps</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072690"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072693"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="PQTree.html#splitForQ"><span class="hs-identifier hs-type">splitForQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span id="splitForQ"><span class="annot"><span class="annottext">splitForQ :: [RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
</span><a href="PQTree.html#splitForQ"><span class="hs-identifier hs-var hs-var">splitForQ</span></a></span></span><span> </span><span id="local-6989586621679072688"><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072688"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
</span><a href="#local-6989586621679072687"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072688"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ([PQNode], Maybe Parts, [PQNode])
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
</span><a href="#local-6989586621679072687"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RNode] -&gt; [RNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[RNode]
</span><a href="#local-6989586621679072688"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679072687"><span class="annot"><span class="annottext">go :: [RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
</span><a href="#local-6989586621679072687"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State [RNode] (Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">(State [RNode] (Maybe ([PQNode], Maybe Parts, [PQNode]))
 -&gt; [RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] (Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode]
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
-&gt; Maybe Parts
-&gt; [PQNode]
-&gt; Bool
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
forall (f :: * -&gt; *) a b c.
Alternative f =&gt;
a -&gt; b -&gt; c -&gt; Bool -&gt; f (a, b, c)
</span><a href="#local-6989586621679072684"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode]
 -&gt; Maybe Parts
 -&gt; [PQNode]
 -&gt; Bool
 -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] [PQNode]
-&gt; StateT
     [RNode]
     Identity
     (Maybe Parts
      -&gt; [PQNode] -&gt; Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] [PQNode]
</span><a href="PQTree.html#emptyMany"><span class="hs-identifier hs-var">emptyMany</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  (Maybe Parts
   -&gt; [PQNode] -&gt; Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] (Maybe Parts)
-&gt; StateT
     [RNode]
     Identity
     ([PQNode] -&gt; Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] (Maybe Parts)
</span><a href="PQTree.html#partialMaybe"><span class="hs-identifier hs-var">partialMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  ([PQNode] -&gt; Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] [PQNode]
-&gt; StateT
     [RNode] Identity (Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] [PQNode]
</span><a href="PQTree.html#fullMany"><span class="hs-identifier hs-var">fullMany</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode] Identity (Bool -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; StateT [RNode] Identity Bool
-&gt; State [RNode] (Maybe ([PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Bool) -&gt; StateT [RNode] Identity Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679072684"><span class="annot"><span class="annottext">go' :: a -&gt; b -&gt; c -&gt; Bool -&gt; f (a, b, c)
</span><a href="#local-6989586621679072684"><span class="hs-identifier hs-var hs-var">go'</span></a></span></span><span> </span><span id="local-6989586621679072680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072680"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679072679"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679072679"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679072678"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679072678"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679072677"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679072677"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072680"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679072679"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679072678"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b, c) -&gt; f () -&gt; f (a, b, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679072677"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="PQTree.html#splitForQRoot"><span class="hs-identifier hs-type">splitForQRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#Parts"><span class="hs-identifier hs-type">Parts</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span id="splitForQRoot"><span class="annot"><span class="annottext">splitForQRoot :: [RNode]
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
</span><a href="PQTree.html#splitForQRoot"><span class="hs-identifier hs-var hs-var">splitForQRoot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
  [RNode]
  (Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode]
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">(State
   [RNode]
   (Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
 -&gt; [RNode]
 -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State
     [RNode]
     (Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode]
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">[PQNode]
-&gt; Maybe Parts
-&gt; [PQNode]
-&gt; Maybe Parts
-&gt; [PQNode]
-&gt; Bool
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
forall (f :: * -&gt; *) a b c d e.
Alternative f =&gt;
a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; Bool -&gt; f (a, b, c, d, e)
</span><a href="#local-6989586621679072674"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode]
 -&gt; Maybe Parts
 -&gt; [PQNode]
 -&gt; Maybe Parts
 -&gt; [PQNode]
 -&gt; Bool
 -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] [PQNode]
-&gt; StateT
     [RNode]
     Identity
     (Maybe Parts
      -&gt; [PQNode]
      -&gt; Maybe Parts
      -&gt; [PQNode]
      -&gt; Bool
      -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] [PQNode]
</span><a href="PQTree.html#emptyMany"><span class="hs-identifier hs-var">emptyMany</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  (Maybe Parts
   -&gt; [PQNode]
   -&gt; Maybe Parts
   -&gt; [PQNode]
   -&gt; Bool
   -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] (Maybe Parts)
-&gt; StateT
     [RNode]
     Identity
     ([PQNode]
      -&gt; Maybe Parts
      -&gt; [PQNode]
      -&gt; Bool
      -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] (Maybe Parts)
</span><a href="PQTree.html#partialMaybe"><span class="hs-identifier hs-var">partialMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  ([PQNode]
   -&gt; Maybe Parts
   -&gt; [PQNode]
   -&gt; Bool
   -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] [PQNode]
-&gt; StateT
     [RNode]
     Identity
     (Maybe Parts
      -&gt; [PQNode]
      -&gt; Bool
      -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] [PQNode]
</span><a href="PQTree.html#fullMany"><span class="hs-identifier hs-var">fullMany</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  (Maybe Parts
   -&gt; [PQNode]
   -&gt; Bool
   -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] (Maybe Parts)
-&gt; StateT
     [RNode]
     Identity
     ([PQNode]
      -&gt; Bool
      -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] (Maybe Parts)
</span><a href="PQTree.html#partialMaybe"><span class="hs-identifier hs-var">partialMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  ([PQNode]
   -&gt; Bool
   -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; State [RNode] [PQNode]
-&gt; StateT
     [RNode]
     Identity
     (Bool
      -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">State [RNode] [PQNode]
</span><a href="PQTree.html#emptyMany"><span class="hs-identifier hs-var">emptyMany</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  [RNode]
  Identity
  (Bool
   -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; StateT [RNode] Identity Bool
-&gt; State
     [RNode]
     (Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Bool) -&gt; StateT [RNode] Identity Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679072674"><span class="annot"><span class="annottext">go :: a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; Bool -&gt; f (a, b, c, d, e)
</span><a href="#local-6989586621679072674"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679072673"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072673"><span class="hs-identifier hs-var">es1</span></a></span></span><span> </span><span id="local-6989586621679072672"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679072672"><span class="hs-identifier hs-var">ps1</span></a></span></span><span> </span><span id="local-6989586621679072671"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679072671"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679072670"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679072670"><span class="hs-identifier hs-var">ps2</span></a></span></span><span> </span><span id="local-6989586621679072669"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679072669"><span class="hs-identifier hs-var">es2</span></a></span></span><span> </span><span id="local-6989586621679072668"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679072668"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072673"><span class="hs-identifier hs-var">es1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679072672"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679072671"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679072670"><span class="hs-identifier hs-var">ps2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679072669"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b, c, d, e) -&gt; f () -&gt; f (a, b, c, d, e)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679072668"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Builds a PQ-tree from a set of Ints. O(n).</span><span>
</span><span id="line-113"></span><span class="annot"><a href="PQTree.html#buildPQ"><span class="hs-identifier hs-type">buildPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-114"></span><span id="buildPQ"><span class="annot"><span class="annottext">buildPQ :: [Int] -&gt; PQNode
</span><a href="PQTree.html#buildPQ"><span class="hs-identifier hs-var hs-var">buildPQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; ([Int] -&gt; [PQNode]) -&gt; [Int] -&gt; PQNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PQNode) -&gt; [Int] -&gt; [PQNode]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PQNode
</span><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-var">PQLeaf</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Reduces a PQ-tree with a set of Ints. This should be a subset of what it was constructed with. O(n).</span><span>
</span><span id="line-117"></span><span class="annot"><a href="PQTree.html#reducePQ"><span class="hs-identifier hs-type">reducePQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-118"></span><span id="reducePQ"><span class="annot"><span class="annottext">reducePQ :: [Int] -&gt; PQNode -&gt; Maybe PQNode
</span><a href="PQTree.html#reducePQ"><span class="hs-identifier hs-var hs-var">reducePQ</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="PQTree.html#reducePQ"><span class="hs-identifier hs-var">reducePQ</span></a></span><span> </span><span id="local-6989586621679072666"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072666"><span class="hs-identifier hs-var">xs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PQNode -&gt; Either Int (Maybe PQNode) -&gt; Maybe PQNode
forall b a. b -&gt; Either a b -&gt; b
</span><span class="hs-identifier hs-var">fromRight</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe PQNode
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;outside initial set&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either Int (Maybe PQNode) -&gt; Maybe PQNode)
-&gt; (PQNode -&gt; Either Int (Maybe PQNode)) -&gt; PQNode -&gt; Maybe PQNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072664"><span class="hs-identifier hs-var">visit</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679072663"><span class="annot"><span class="annottext">xs :: IntSet
</span><a href="#local-6989586621679072663"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072666"><span class="hs-identifier hs-var">xs0</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679072661"><span class="annot"><span class="annottext">xsz :: Int
</span><a href="#local-6989586621679072661"><span class="hs-identifier hs-var hs-var">xsz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Int
</span><span class="hs-identifier hs-var">IS.size</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679072663"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621679072664"><span class="hs-identifier hs-type">visit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679072664"><span class="annot"><span class="annottext">visit :: PQNode -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072664"><span class="hs-identifier hs-var hs-var">visit</span></a></span></span><span> </span><span id="local-6989586621679072659"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072659"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072658"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072658"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode
-&gt; ([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072657"><span class="hs-identifier hs-var">visitPQ</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072659"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#PNode"><span class="hs-identifier hs-var">PNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072658"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621679072664"><span class="hs-identifier hs-var">visit</span></a></span><span> </span><span id="local-6989586621679072656"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072656"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072655"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072655"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode
-&gt; ([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072657"><span class="hs-identifier hs-var">visitPQ</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072656"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#QNode"><span class="hs-identifier hs-var">QNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072655"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621679072664"><span class="hs-identifier hs-var">visit</span></a></span><span> </span><span id="local-6989586621679072654"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072654"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span id="local-6989586621679072653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072653"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072653"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntSet -&gt; Bool
</span><span class="hs-operator hs-var">`IS.notMember`</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679072663"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either Int (Maybe PQNode)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072661"><span class="hs-identifier hs-var">xsz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either Int (Maybe PQNode)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PQNode -&gt; Either Int (Maybe PQNode))
-&gt; Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
</span><a href="#local-6989586621679072650"><span class="hs-identifier hs-var">reduceRoot</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072654"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679072657"><span class="annot"><span class="annottext">visitPQ :: PQNode
-&gt; ([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072657"><span class="hs-identifier hs-var hs-var">visitPQ</span></a></span></span><span> </span><span id="local-6989586621679072649"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072649"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679072648"><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="#local-6989586621679072648"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679072647"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072647"><span class="hs-identifier hs-var">cs</span></a></span></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072646"><span class="hs-identifier hs-var">cnt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072661"><span class="hs-identifier hs-var">xsz</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PQNode -&gt; Either Int (Maybe PQNode))
-&gt; Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
</span><a href="#local-6989586621679072650"><span class="hs-identifier hs-var">reduceRoot</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072649"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Maybe PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Maybe PQNode]
</span><a href="#local-6989586621679072645"><span class="hs-identifier hs-var">rts</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either Int (Maybe PQNode)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072646"><span class="hs-identifier hs-var">cnt</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">[</span><span id="local-6989586621679072644"><span class="annot"><span class="annottext">Maybe PQNode
</span><a href="#local-6989586621679072644"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe PQNode]
</span><a href="#local-6989586621679072645"><span class="hs-identifier hs-var">rts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PQNode -&gt; Either Int (Maybe PQNode))
-&gt; Maybe PQNode -&gt; Either Int (Maybe PQNode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="#local-6989586621679072648"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; (PQNode -&gt; [PQNode]) -&gt; PQNode -&gt; PQNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode]
</span><a href="#local-6989586621679072643"><span class="hs-identifier hs-var">getcs'</span></a></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; PQNode) -&gt; Maybe PQNode -&gt; Maybe PQNode
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe PQNode
</span><a href="#local-6989586621679072644"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>        </span><span id="local-6989586621679072642"><span class="annot"><span class="annottext">ys :: [Either Int (Maybe PQNode)]
</span><a href="#local-6989586621679072642"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Either Int (Maybe PQNode))
-&gt; [PQNode] -&gt; [Either Int (Maybe PQNode)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Either Int (Maybe PQNode)
</span><a href="#local-6989586621679072664"><span class="hs-identifier hs-var">visit</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072647"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span id="local-6989586621679072646"><span class="annot"><span class="annottext">cnt :: Int
</span><a href="#local-6989586621679072646"><span class="hs-identifier hs-var hs-var">cnt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either Int (Maybe PQNode)] -&gt; [Int]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either Int (Maybe PQNode)]
</span><a href="#local-6989586621679072642"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span id="local-6989586621679072645"><span class="annot"><span class="annottext">rts :: [Maybe PQNode]
</span><a href="#local-6989586621679072645"><span class="hs-identifier hs-var hs-var">rts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Int (Maybe PQNode)] -&gt; [Maybe PQNode]
forall a b. [Either a b] -&gt; [b]
</span><span class="hs-identifier hs-var">rights</span></span><span> </span><span class="annot"><span class="annottext">[Either Int (Maybe PQNode)]
</span><a href="#local-6989586621679072642"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679072643"><span class="annot"><span class="annottext">getcs' :: PQNode -&gt; [PQNode]
</span><a href="#local-6989586621679072643"><span class="hs-identifier hs-var hs-var">getcs'</span></a></span></span><span> </span><span id="local-6989586621679072638"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072638"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Either Int (Maybe PQNode) -&gt; PQNode)
-&gt; [PQNode] -&gt; [Either Int (Maybe PQNode)] -&gt; [PQNode]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679072636"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072636"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PQNode)
-&gt; (Maybe PQNode -&gt; PQNode) -&gt; Either Int (Maybe PQNode) -&gt; PQNode
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode -&gt; Int -&gt; PQNode
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072636"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode -&gt; PQNode
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072638"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072647"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Either Int (Maybe PQNode)]
</span><a href="#local-6989586621679072642"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="#local-6989586621679072650"><span class="hs-identifier hs-type">reduceRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679072650"><span class="annot"><span class="annottext">reduceRoot :: PQNode -&gt; Maybe PQNode
</span><a href="#local-6989586621679072650"><span class="hs-identifier hs-var hs-var">reduceRoot</span></a></span></span><span> </span><span id="local-6989586621679072633"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072633"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072632"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072632"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([PQNode], [Parts], [PQNode]) -&gt; Maybe PQNode
</span><a href="#local-6989586621679072631"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(([PQNode], [Parts], [PQNode]) -&gt; Maybe PQNode)
-&gt; ([RNode] -&gt; ([PQNode], [Parts], [PQNode]))
-&gt; [RNode]
-&gt; Maybe PQNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="PQTree.html#splitForP"><span class="hs-identifier hs-var">splitForP</span></a></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Maybe PQNode) -&gt; Maybe [RNode] -&gt; Maybe PQNode
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe RNode) -&gt; [PQNode] -&gt; Maybe [RNode]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe RNode
</span><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072632"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679072631"><span class="annot"><span class="annottext">go :: ([PQNode], [Parts], [PQNode]) -&gt; Maybe PQNode
</span><a href="#local-6989586621679072631"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072627"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072627"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072626"><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072626"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072625"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072625"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072626"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072624"><span class="hs-identifier hs-var">noPartial</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621679072623"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072623"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe PQNode) -&gt; PQNode -&gt; Maybe PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parts -&gt; Parts -&gt; PQNode
</span><a href="#local-6989586621679072622"><span class="hs-identifier hs-var">withPartial</span></a></span><span> </span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072623"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621679072621"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072621"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072620"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072620"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe PQNode) -&gt; PQNode -&gt; Maybe PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parts -&gt; Parts -&gt; PQNode
</span><a href="#local-6989586621679072622"><span class="hs-identifier hs-var">withPartial</span></a></span><span> </span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072621"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072620"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="annottext">[Parts]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PQNode
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-147"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>            </span><span id="local-6989586621679072624"><span class="annot"><span class="annottext">noPartial :: PQNode
</span><a href="#local-6989586621679072624"><span class="hs-identifier hs-var hs-var">noPartial</span></a></span></span><span>
</span><span id="line-149"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072627"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072625"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072633"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-150"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072625"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072627"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span id="local-6989586621679072622"><span class="annot"><span class="annottext">withPartial :: Parts -&gt; Parts -&gt; PQNode
</span><a href="#local-6989586621679072622"><span class="hs-identifier hs-var hs-var">withPartial</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072618"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072618"><span class="hs-identifier hs-var">pe1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072617"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072617"><span class="hs-identifier hs-var">pf1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072616"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072616"><span class="hs-identifier hs-var">pe2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072615"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072615"><span class="hs-identifier hs-var">pf2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072614"><span class="hs-identifier hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [PQNode] -&gt; [PQNode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072627"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>                </span><span id="local-6989586621679072614"><span class="annot"><span class="annottext">qn :: PQNode
</span><a href="#local-6989586621679072614"><span class="hs-identifier hs-var hs-var">qn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var">mkQNode</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-153"></span><span>                    </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072618"><span class="hs-identifier hs-var">pe1</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072617"><span class="hs-identifier hs-var">pf1</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072625"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072625"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072615"><span class="hs-identifier hs-var">pf2</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072616"><span class="hs-identifier hs-var">pe2</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="#local-6989586621679072650"><span class="hs-identifier hs-var">reduceRoot</span></a></span><span> </span><span id="local-6989586621679072612"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072612"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072611"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072611"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
 -&gt; PQNode)
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
-&gt; Maybe PQNode
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]) -&gt; PQNode
</span><a href="#local-6989586621679072610"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
 -&gt; Maybe PQNode)
-&gt; ([RNode]
    -&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode]
-&gt; Maybe PQNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[RNode]
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode])
</span><a href="PQTree.html#splitForQRoot"><span class="hs-identifier hs-var">splitForQRoot</span></a></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Maybe PQNode) -&gt; Maybe [RNode] -&gt; Maybe PQNode
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe RNode) -&gt; [PQNode] -&gt; Maybe [RNode]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe RNode
</span><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072611"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679072610"><span class="annot"><span class="annottext">go :: ([PQNode], Maybe Parts, [PQNode], Maybe Parts, [PQNode]) -&gt; PQNode
</span><a href="#local-6989586621679072610"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072609"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072609"><span class="hs-identifier hs-var">es1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072608"><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072608"><span class="hs-identifier hs-var">ps1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072607"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072607"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072606"><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072606"><span class="hs-identifier hs-var">ps2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072605"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072605"><span class="hs-identifier hs-var">es2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072608"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072606"><span class="hs-identifier hs-var">ps2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Parts
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Parts
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072612"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">(Maybe Parts, Maybe Parts)
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parts -&gt; Parts -&gt; PQNode
</span><a href="#local-6989586621679072604"><span class="hs-identifier hs-var">withPartial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parts -&gt; Maybe Parts -&gt; Parts
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072608"><span class="hs-identifier hs-var">ps1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parts -&gt; Maybe Parts -&gt; Parts
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072606"><span class="hs-identifier hs-var">ps2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>            </span><span id="local-6989586621679072604"><span class="annot"><span class="annottext">withPartial :: Parts -&gt; Parts -&gt; PQNode
</span><a href="#local-6989586621679072604"><span class="hs-identifier hs-var hs-var">withPartial</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072602"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072602"><span class="hs-identifier hs-var">pe1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072601"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072601"><span class="hs-identifier hs-var">pf1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072600"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072600"><span class="hs-identifier hs-var">pe2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072599"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072599"><span class="hs-identifier hs-var">pf2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>                </span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkQNode"><span class="hs-identifier hs-var">mkQNode</span></a></span><span> </span><span class="annot"><span class="annottext">([PQNode] -&gt; PQNode) -&gt; [PQNode] -&gt; PQNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072609"><span class="hs-identifier hs-var">es1</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072602"><span class="hs-identifier hs-var">pe1</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072601"><span class="hs-identifier hs-var">pf1</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072607"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072599"><span class="hs-identifier hs-var">pf2</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072600"><span class="hs-identifier hs-var">pe2</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072605"><span class="hs-identifier hs-var">es2</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="#local-6989586621679072650"><span class="hs-identifier hs-var">reduceRoot</span></a></span><span> </span><span id="local-6989586621679072598"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072598"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe PQNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072598"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="#local-6989586621679072628"><span class="hs-identifier hs-type">reduceInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#RNode"><span class="hs-identifier hs-type">RNode</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679072628"><span class="annot"><span class="annottext">reduceInternal :: PQNode -&gt; Maybe RNode
</span><a href="#local-6989586621679072628"><span class="hs-identifier hs-var hs-var">reduceInternal</span></a></span></span><span> </span><span id="local-6989586621679072597"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072597"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072596"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072596"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([PQNode], [Parts], [PQNode]) -&gt; Maybe RNode
</span><a href="#local-6989586621679072595"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(([PQNode], [Parts], [PQNode]) -&gt; Maybe RNode)
-&gt; ([RNode] -&gt; ([PQNode], [Parts], [PQNode]))
-&gt; [RNode]
-&gt; Maybe RNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; ([PQNode], [Parts], [PQNode])
</span><a href="PQTree.html#splitForP"><span class="hs-identifier hs-var">splitForP</span></a></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Maybe RNode) -&gt; Maybe [RNode] -&gt; Maybe RNode
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe RNode) -&gt; [PQNode] -&gt; Maybe [RNode]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe RNode
</span><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072596"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>        </span><span id="local-6989586621679072595"><span class="annot"><span class="annottext">go :: ([PQNode], [Parts], [PQNode]) -&gt; Maybe RNode
</span><a href="#local-6989586621679072595"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072594"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072594"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072593"><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072593"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072592"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072592"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Parts]
</span><a href="#local-6989586621679072593"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RNode -&gt; Maybe RNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">RNode
</span><a href="#local-6989586621679072591"><span class="hs-identifier hs-var">noPartial</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621679072590"><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072590"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RNode -&gt; Maybe RNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RNode -&gt; Maybe RNode) -&gt; RNode -&gt; Maybe RNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parts -&gt; RNode
</span><a href="#local-6989586621679072589"><span class="hs-identifier hs-var">withPartial</span></a></span><span> </span><span class="annot"><span class="annottext">Parts
</span><a href="#local-6989586621679072590"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">[Parts]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe RNode
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>            </span><span id="local-6989586621679072591"><span class="annot"><span class="annottext">noPartial :: RNode
</span><a href="#local-6989586621679072591"><span class="hs-identifier hs-var hs-var">noPartial</span></a></span></span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072594"><span class="hs-identifier hs-var">es</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072597"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072592"><span class="hs-identifier hs-var">fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072597"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-175"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; RNode
</span><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072594"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072592"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>            </span><span id="local-6989586621679072589"><span class="annot"><span class="annottext">withPartial :: Parts -&gt; RNode
</span><a href="#local-6989586621679072589"><span class="hs-identifier hs-var hs-var">withPartial</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072588"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072588"><span class="hs-identifier hs-var">pe</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072587"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072587"><span class="hs-identifier hs-var">pf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; RNode
</span><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span>
</span><span id="line-177"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072594"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072594"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072588"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PQNode] -&gt; PQNode
</span><a href="PQTree.html#mkPNode"><span class="hs-identifier hs-var">mkPNode</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072592"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072592"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072587"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span id="local-6989586621679072586"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072586"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072585"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072585"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([PQNode], Maybe Parts, [PQNode]) -&gt; RNode)
-&gt; Maybe ([PQNode], Maybe Parts, [PQNode]) -&gt; Maybe RNode
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([PQNode], Maybe Parts, [PQNode]) -&gt; RNode
</span><a href="#local-6989586621679072584"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ([PQNode], Maybe Parts, [PQNode]) -&gt; Maybe RNode)
-&gt; ([RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode]))
-&gt; [RNode]
-&gt; Maybe RNode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[RNode] -&gt; Maybe ([PQNode], Maybe Parts, [PQNode])
</span><a href="PQTree.html#splitForQ"><span class="hs-identifier hs-var">splitForQ</span></a></span><span> </span><span class="annot"><span class="annottext">([RNode] -&gt; Maybe RNode) -&gt; Maybe [RNode] -&gt; Maybe RNode
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; Maybe RNode) -&gt; [PQNode] -&gt; Maybe [RNode]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; Maybe RNode
</span><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072585"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>        </span><span id="local-6989586621679072584"><span class="annot"><span class="annottext">go :: ([PQNode], Maybe Parts, [PQNode]) -&gt; RNode
</span><a href="#local-6989586621679072584"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072583"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072583"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072582"><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072582"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072581"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072581"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RNode -&gt; (Parts -&gt; RNode) -&gt; Maybe Parts -&gt; RNode
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">RNode
</span><a href="#local-6989586621679072579"><span class="hs-identifier hs-var">noPartial</span></a></span><span> </span><span class="annot"><span class="annottext">Parts -&gt; RNode
</span><a href="#local-6989586621679072578"><span class="hs-identifier hs-var">withPartial</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Parts
</span><a href="#local-6989586621679072582"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>            </span><span id="local-6989586621679072579"><span class="annot"><span class="annottext">noPartial :: RNode
</span><a href="#local-6989586621679072579"><span class="hs-identifier hs-var hs-var">noPartial</span></a></span></span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072583"><span class="hs-identifier hs-var">es</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072586"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072581"><span class="hs-identifier hs-var">fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072586"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; RNode
</span><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072583"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072581"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>            </span><span id="local-6989586621679072578"><span class="annot"><span class="annottext">withPartial :: Parts -&gt; RNode
</span><a href="#local-6989586621679072578"><span class="hs-identifier hs-var hs-var">withPartial</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679072577"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072577"><span class="hs-identifier hs-var">pe</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072576"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072576"><span class="hs-identifier hs-var">pf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; RNode
</span><a href="PQTree.html#mkPartial"><span class="hs-identifier hs-var">mkPartial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072583"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072577"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072581"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; [PQNode] -&gt; [PQNode]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072576"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679072628"><span class="hs-identifier hs-var">reduceInternal</span></a></span><span> </span><span id="local-6989586621679072575"><span class="annot"><span class="annottext">n :: PQNode
</span><a href="#local-6989586621679072575"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span id="local-6989586621679072574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072574"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RNode -&gt; Maybe RNode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RNode -&gt; Maybe RNode) -&gt; RNode -&gt; Maybe RNode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072574"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntSet -&gt; Bool
</span><span class="hs-operator hs-var">`IS.member`</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679072663"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072575"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; RNode
</span><a href="PQTree.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072575"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Reduces a PQ-tree with many sets. O(mn) for m sets.</span><span>
</span><span id="line-190"></span><span class="annot"><a href="PQTree.html#reduceAllPQ"><span class="hs-identifier hs-type">reduceAllPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span>
</span><span id="line-191"></span><span id="reduceAllPQ"><span class="annot"><span class="annottext">reduceAllPQ :: [[Int]] -&gt; PQNode -&gt; Maybe PQNode
</span><a href="PQTree.html#reduceAllPQ"><span class="hs-identifier hs-var hs-var">reduceAllPQ</span></a></span></span><span> </span><span id="local-6989586621679072572"><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679072572"><span class="hs-identifier hs-var">xss</span></a></span></span><span> </span><span id="local-6989586621679072571"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072571"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [Int] -&gt; Maybe PQNode)
-&gt; PQNode -&gt; [[Int]] -&gt; Maybe PQNode
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Int] -&gt; PQNode -&gt; Maybe PQNode)
-&gt; PQNode -&gt; [Int] -&gt; Maybe PQNode
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; PQNode -&gt; Maybe PQNode
</span><a href="PQTree.html#reducePQ"><span class="hs-identifier hs-var">reducePQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072571"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679072572"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | The frontier of the PQ-tree. O(n).</span><span>
</span><span id="line-194"></span><span class="annot"><a href="PQTree.html#frontierPQ"><span class="hs-identifier hs-type">frontierPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span id="frontierPQ"><span class="annot"><span class="annottext">frontierPQ :: PQNode -&gt; [Int]
</span><a href="PQTree.html#frontierPQ"><span class="hs-identifier hs-var hs-var">frontierPQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [Int] -&gt; [Int]) -&gt; [Int] -&gt; PQNode -&gt; [Int]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [Int] -&gt; [Int]
</span><a href="#local-6989586621679072568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679072568"><span class="annot"><span class="annottext">go :: PQNode -&gt; [Int] -&gt; [Int]
</span><a href="#local-6989586621679072568"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span id="local-6989586621679072567"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072567"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679072566"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072566"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072567"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072566"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="#local-6989586621679072568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072565"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072565"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679072564"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072564"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [Int] -&gt; [Int]) -&gt; [Int] -&gt; [PQNode] -&gt; [Int]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [Int] -&gt; [Int]
</span><a href="#local-6989586621679072568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072564"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072565"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621679072568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072562"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072562"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679072561"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072561"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [Int] -&gt; [Int]) -&gt; [Int] -&gt; [PQNode] -&gt; [Int]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [Int] -&gt; [Int]
</span><a href="#local-6989586621679072568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679072561"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072562"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | The permutations represented by the PQ-tree. O(do not use).</span><span>
</span><span id="line-201"></span><span class="annot"><a href="PQTree.html#permsPQ"><span class="hs-identifier hs-type">permsPQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span id="permsPQ"><span class="annot"><span class="annottext">permsPQ :: PQNode -&gt; [[Int]]
</span><a href="PQTree.html#permsPQ"><span class="hs-identifier hs-var hs-var">permsPQ</span></a></span></span><span> </span><span id="local-6989586621679072560"><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072560"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PQNode
</span><a href="#local-6989586621679072560"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span id="local-6989586621679072559"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072559"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072559"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072558"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072558"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([[[Int]]] -&gt; [[Int]]) -&gt; [[[[Int]]]] -&gt; [[Int]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">[[[Int]]] -&gt; [[Int]]
forall a. [[[a]]] -&gt; [[a]]
</span><a href="#local-6989586621679072556"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="annot"><span class="annottext">([[[[Int]]]] -&gt; [[Int]]) -&gt; [[[[Int]]]] -&gt; [[Int]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[[Int]]] -&gt; [[[[Int]]]]
forall a. [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">permutations</span></span><span> </span><span class="annot"><span class="annottext">([[[Int]]] -&gt; [[[[Int]]]]) -&gt; [[[Int]]] -&gt; [[[[Int]]]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [[Int]]) -&gt; [PQNode] -&gt; [[[Int]]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [[Int]]
</span><a href="PQTree.html#permsPQ"><span class="hs-identifier hs-var">permsPQ</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072558"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072554"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072554"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[[Int]]] -&gt; [[Int]]
forall a. [[[a]]] -&gt; [[a]]
</span><a href="#local-6989586621679072556"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PQNode -&gt; [[Int]]) -&gt; [PQNode] -&gt; [[[Int]]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [[Int]]
</span><a href="PQTree.html#permsPQ"><span class="hs-identifier hs-var">permsPQ</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072554"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Int]] -&gt; [[Int]] -&gt; [[Int]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[[Int]]] -&gt; [[Int]]
forall a. [[[a]]] -&gt; [[a]]
</span><a href="#local-6989586621679072556"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[[Int]]] -&gt; [[[Int]]]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([[[Int]]] -&gt; [[[Int]]]) -&gt; [[[Int]]] -&gt; [[[Int]]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PQNode -&gt; [[Int]]) -&gt; [PQNode] -&gt; [[[Int]]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PQNode -&gt; [[Int]]
</span><a href="PQTree.html#permsPQ"><span class="hs-identifier hs-var">permsPQ</span></a></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072554"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679072556"><span class="annot"><span class="annottext">prod :: [[[a]]] -&gt; [[a]]
</span><a href="#local-6989586621679072556"><span class="hs-identifier hs-var hs-var">prod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; [a]) -&gt; [[[a]]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[[a]]] -&gt; [[a]]) -&gt; ([[[a]]] -&gt; [[[a]]]) -&gt; [[[a]]] -&gt; [[a]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[[a]]] -&gt; [[[a]]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Note: permsPQ is far from optimal, but it is unlikely to be used with larger values of n anyway</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- For tests</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="PQTree.html#PQNode"><span class="hs-identifier hs-type">PQNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679072549"><span class="annot"><span class="annottext">rnf :: PQNode -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PQLeaf"><span class="hs-identifier hs-type">PQLeaf</span></a></span><span> </span><span id="local-6989586621679072547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072547"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072547"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#PNode"><span class="hs-identifier hs-type">PNode</span></a></span><span> </span><span id="local-6989586621679072546"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072546"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072546"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PQTree.html#QNode"><span class="hs-identifier hs-type">QNode</span></a></span><span> </span><span id="local-6989586621679072545"><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072545"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PQNode] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[PQNode]
</span><a href="#local-6989586621679072545"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-218"></span></pre></body></html>