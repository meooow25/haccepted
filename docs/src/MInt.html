<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">{-|
== Modular arithmetic

Instances of Eq, Num, Fractional exist for MInt. All the usual operations take O(1) time, except for
recip which takes O(log m) time.
An instance of Enum exists for MInt. The enum is cyclic, it wraps to 0 after m-1.
An instance of IArray UArray MInt exists. Instances of MArray (STUArray s) MInt (ST s) and
MArray IOUArray MInt IO are also defined.

-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">{-
Implementation notes:
* MInt is a newtype of Int, change to Int64 if running on 32-bit.
* Regarding unsafeCoerce (trust me it's safe!), type roles for unboxed arrays are nominal (and not
  representational), so trying to derive unboxed arrays for MInt does not work (see
  https://gitlab.haskell.org/ghc/ghc/-/issues/9220). As I see it my options are
    a. spill more guts out of Array.Base and Array.IO to copy-paste everything an Int array does
    b. use unsafeCoerce
  I would love to hear of a better way.
-}</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MInt</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier">MInt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MInt.html#mkMInt"><span class="hs-identifier">mkMInt</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MInt.html#inv"><span class="hs-identifier">inv</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.Base</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.IO</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><a href="MInt.html#m"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-38"></span><span id="m"><span class="annot"><span class="annottext">m :: Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000007</span></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- m = 998244353</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Integer type for modular arithmetic, using fixed prime modulo.</span><span>
</span><span id="line-42"></span><span class="hs-keyword">newtype</span><span> </span><span id="MInt"><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MInt"><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="toInt"><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#toInt"><span class="hs-identifier hs-var hs-var">toInt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065381"><span id="local-6989586621679065383"><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
(MInt -&gt; MInt -&gt; Bool) -&gt; (MInt -&gt; MInt -&gt; Bool) -&gt; Eq MInt
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MInt -&gt; MInt -&gt; Bool
$c/= :: MInt -&gt; MInt -&gt; Bool
== :: MInt -&gt; MInt -&gt; Bool
$c== :: MInt -&gt; MInt -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065374"><span id="local-6989586621679065376"><span id="local-6989586621679065378"><span class="annot"><span class="annottext">Int -&gt; MInt -&gt; ShowS
[MInt] -&gt; ShowS
MInt -&gt; String
(Int -&gt; MInt -&gt; ShowS)
-&gt; (MInt -&gt; String) -&gt; ([MInt] -&gt; ShowS) -&gt; Show MInt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MInt] -&gt; ShowS
$cshowList :: [MInt] -&gt; ShowS
show :: MInt -&gt; String
$cshow :: MInt -&gt; String
showsPrec :: Int -&gt; MInt -&gt; ShowS
$cshowsPrec :: Int -&gt; MInt -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Int to MInt. The MInt constructor can be used directly if the value is known to be in [0.. m-1].</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- O(1).</span><span>
</span><span id="line-46"></span><span class="annot"><a href="MInt.html#mkMInt"><span class="hs-identifier hs-type">mkMInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span>
</span><span id="line-47"></span><span id="mkMInt"><span class="annot"><span class="annottext">mkMInt :: Int -&gt; MInt
</span><a href="MInt.html#mkMInt"><span class="hs-identifier hs-var hs-var">mkMInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; (Int -&gt; Int) -&gt; Int -&gt; MInt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065366"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065361"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065361"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679065360"><span class="annot"><span class="annottext">+ :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065358"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679065357"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065361"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679065355"><span class="annot"><span class="annottext">- :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065354"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679065353"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065354"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065351"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065351"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679065350"><span class="annot"><span class="annottext">* :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679065348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065348"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065351"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065348"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679065347"><span class="annot"><span class="annottext">abs :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679065344"><span class="annot"><span class="annottext">signum :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; (MInt -&gt; Int) -&gt; MInt -&gt; MInt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (MInt -&gt; Int) -&gt; MInt -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#toInt"><span class="hs-identifier hs-var hs-var">toInt</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679065342"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; (Integer -&gt; Int) -&gt; Integer -&gt; MInt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; (Integer -&gt; Integer) -&gt; Integer -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Reciprocal of an MInt. O(log m).</span><span>
</span><span id="line-58"></span><span class="annot"><a href="MInt.html#inv"><span class="hs-identifier hs-type">inv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span>
</span><span id="line-59"></span><span id="inv"><span class="annot"><span class="annottext">inv :: MInt -&gt; MInt
</span><a href="MInt.html#inv"><span class="hs-identifier hs-var hs-var">inv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int -&gt; MInt
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065338"><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679065334"><span class="annot"><span class="annottext">recip :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int -&gt; MInt
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#m"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679065332"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span id="local-6989586621679065331"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679065331"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679065331"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679065331"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065318"><span id="local-6989586621679065320"><span id="local-6989586621679065324"><span id="local-6989586621679065326"><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679065314"><span class="annot"><span class="annottext">toEnum :: Int -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEnum</span></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679065312"><span class="annot"><span class="annottext">fromEnum :: MInt -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromEnum</span></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#toInt"><span class="hs-identifier hs-var hs-var">toInt</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621679065310"><span class="annot"><span class="annottext">enumFromTo :: MInt -&gt; MInt -&gt; [MInt]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromTo</span></span></span><span> </span><span id="local-6989586621679065309"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065309"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679065308"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065308"><span class="hs-identifier hs-var">y</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MInt -&gt; Bool) -&gt; [MInt] -&gt; [MInt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065308"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065309"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679065305"><span class="annot"><span class="annottext">enumFromThenTo :: MInt -&gt; MInt -&gt; MInt -&gt; [MInt]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromThenTo</span></span></span><span> </span><span id="local-6989586621679065304"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065304"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679065303"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065303"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679065302"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065302"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MInt -&gt; Bool) -&gt; [MInt] -&gt; [MInt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065302"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065304"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065303"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Unboxed array support</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679065445"><span class="annot"><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-type">coerceUIM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065445"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065445"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span>
</span><span id="line-75"></span><span id="coerceUIM"><span class="annot"><span class="annottext">coerceUIM :: UArray i Int -&gt; UArray i MInt
</span><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-var hs-var">coerceUIM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; UArray i MInt
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679065448"><span class="annot"><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-type">coerceUMI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065448"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065448"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-78"></span><span id="coerceUMI"><span class="annot"><span class="annottext">coerceUMI :: UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var hs-var">coerceUMI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679065290"><span class="annot"><span class="annottext">bounds :: UArray i MInt -&gt; (i, i)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bounds</span></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; (i, i)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">bounds</span></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; (i, i))
-&gt; (UArray i MInt -&gt; UArray i Int) -&gt; UArray i MInt -&gt; (i, i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall i. UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var">coerceUMI</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679065288"><span class="annot"><span class="annottext">numElements :: UArray i MInt -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">numElements</span></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; Int
</span><span class="hs-identifier hs-var">numElements</span></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; Int)
-&gt; (UArray i MInt -&gt; UArray i Int) -&gt; UArray i MInt -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall i. UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var">coerceUMI</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679065286"><span class="annot"><span class="annottext">unsafeArray :: (i, i) -&gt; [(Int, MInt)] -&gt; UArray i MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeArray</span></span></span><span> </span><span id="local-6989586621679065284"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065284"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679065283"><span class="annot"><span class="annottext">[(Int, MInt)]
</span><a href="#local-6989586621679065283"><span class="hs-identifier hs-var">ies</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; UArray i MInt
forall i. UArray i Int -&gt; UArray i MInt
</span><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-var">coerceUIM</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; UArray i MInt) -&gt; UArray i Int -&gt; UArray i MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; [(Int, Int)] -&gt; UArray i Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [(Int, e)] -&gt; a i e
</span><span class="hs-identifier hs-var">unsafeArray</span></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065284"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, MInt)] -&gt; [(Int, Int)]
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">[(Int, MInt)]
</span><a href="#local-6989586621679065283"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679065282"><span class="annot"><span class="annottext">unsafeAt :: UArray i MInt -&gt; Int -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeAt</span></span></span><span> </span><span id="local-6989586621679065280"><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065280"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065279"><span class="hs-identifier hs-var">i</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">unsafeAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall i. UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var">coerceUMI</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065280"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065279"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679065278"><span class="annot"><span class="annottext">unsafeReplace :: UArray i MInt -&gt; [(Int, MInt)] -&gt; UArray i MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeReplace</span></span></span><span> </span><span id="local-6989586621679065276"><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065276"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065275"><span class="annot"><span class="annottext">[(Int, MInt)]
</span><a href="#local-6989586621679065275"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; UArray i MInt
forall i. UArray i Int -&gt; UArray i MInt
</span><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-var">coerceUIM</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; UArray i MInt) -&gt; UArray i Int -&gt; UArray i MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; [(Int, Int)] -&gt; UArray i Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; [(Int, e)] -&gt; a i e
</span><span class="hs-identifier hs-var">unsafeReplace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall i. UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var">coerceUMI</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065276"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, MInt)] -&gt; [(Int, Int)]
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">[(Int, MInt)]
</span><a href="#local-6989586621679065275"><span class="hs-identifier hs-var">ies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679065274"><span class="annot"><span class="annottext">unsafeAccum :: (MInt -&gt; e' -&gt; MInt)
-&gt; UArray i MInt -&gt; [(Int, e')] -&gt; UArray i MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeAccum</span></span></span><span> </span><span id="local-6989586621679065272"><span class="annot"><span class="annottext">MInt -&gt; e' -&gt; MInt
</span><a href="#local-6989586621679065272"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679065271"><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065271"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065270"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679065270"><span class="hs-identifier hs-var">ies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; UArray i MInt
forall i. UArray i Int -&gt; UArray i MInt
</span><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-var">coerceUIM</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; UArray i MInt) -&gt; UArray i Int -&gt; UArray i MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; e' -&gt; Int) -&gt; UArray i Int -&gt; [(Int, e')] -&gt; UArray i Int
forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; a i e -&gt; [(Int, e')] -&gt; a i e
</span><span class="hs-identifier hs-var">unsafeAccum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MInt -&gt; e' -&gt; MInt) -&gt; Int -&gt; e' -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; e' -&gt; MInt
</span><a href="#local-6989586621679065272"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UArray i MInt -&gt; UArray i Int
forall i. UArray i MInt -&gt; UArray i Int
</span><a href="MInt.html#coerceUMI"><span class="hs-identifier hs-var">coerceUMI</span></a></span><span> </span><span class="annot"><span class="annottext">UArray i MInt
</span><a href="#local-6989586621679065271"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679065270"><span class="hs-identifier hs-var">ies</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679065269"><span class="annot"><span class="annottext">unsafeAccumArray :: (MInt -&gt; e' -&gt; MInt)
-&gt; MInt -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeAccumArray</span></span></span><span> </span><span id="local-6989586621679065267"><span class="annot"><span class="annottext">MInt -&gt; e' -&gt; MInt
</span><a href="#local-6989586621679065267"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679065266"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span id="local-6989586621679065265"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065265"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679065264"><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679065264"><span class="hs-identifier hs-var">ies</span></a></span></span><span>
</span><span id="line-88"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray i Int -&gt; UArray i MInt
forall i. UArray i Int -&gt; UArray i MInt
</span><a href="MInt.html#coerceUIM"><span class="hs-identifier hs-var">coerceUIM</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray i Int -&gt; UArray i MInt) -&gt; UArray i Int -&gt; UArray i MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; e' -&gt; Int) -&gt; Int -&gt; (i, i) -&gt; [(Int, e')] -&gt; UArray i Int
forall (a :: * -&gt; * -&gt; *) e i e'.
(IArray a e, Ix i) =&gt;
(e -&gt; e' -&gt; e) -&gt; e -&gt; (i, i) -&gt; [(Int, e')] -&gt; a i e
</span><span class="hs-identifier hs-var">unsafeAccumArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MInt -&gt; e' -&gt; MInt) -&gt; Int -&gt; e' -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; e' -&gt; MInt
</span><a href="#local-6989586621679065267"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">initialValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065265"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, e')]
</span><a href="#local-6989586621679065264"><span class="hs-identifier hs-var">ies</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621679065408"><span id="local-6989586621679065409"><span class="annot"><a href="MInt.html#coerceSTIM"><span class="hs-identifier hs-type">coerceSTIM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065409"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065409"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span></span><span>
</span><span id="line-91"></span><span id="coerceSTIM"><span class="annot"><span class="annottext">coerceSTIM :: STUArray s i Int -&gt; STUArray s i MInt
</span><a href="MInt.html#coerceSTIM"><span class="hs-identifier hs-var hs-var">coerceSTIM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; STUArray s i MInt
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679065415"><span id="local-6989586621679065416"><span class="annot"><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-type">coerceSTMI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065416"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065415"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065416"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065415"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-94"></span><span id="coerceSTMI"><span class="annot"><span class="annottext">coerceSTMI :: STUArray s i MInt -&gt; STUArray s i Int
</span><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-var hs-var">coerceSTMI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s i MInt -&gt; STUArray s i Int
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621679065261"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065256"><span class="annot"><span class="hs-identifier hs-type">MArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065261"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679065261"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679065250"><span class="annot"><span class="annottext">getBounds :: STUArray s i MInt -&gt; ST s (i, i)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getBounds</span></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; ST s (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><span class="hs-identifier hs-var">getBounds</span></span><span> </span><span class="annot"><span class="annottext">(STUArray s i Int -&gt; ST s (i, i))
-&gt; (STUArray s i MInt -&gt; STUArray s i Int)
-&gt; STUArray s i MInt
-&gt; ST s (i, i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">STUArray s i MInt -&gt; STUArray s i Int
forall s i. STUArray s i MInt -&gt; STUArray s i Int
</span><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-var">coerceSTMI</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679065248"><span class="annot"><span class="annottext">getNumElements :: STUArray s i MInt -&gt; ST s Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getNumElements</span></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; ST s Int
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m Int
</span><span class="hs-identifier hs-var">getNumElements</span></span><span> </span><span class="annot"><span class="annottext">(STUArray s i Int -&gt; ST s Int)
-&gt; (STUArray s i MInt -&gt; STUArray s i Int)
-&gt; STUArray s i MInt
-&gt; ST s Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">STUArray s i MInt -&gt; STUArray s i Int
forall s i. STUArray s i MInt -&gt; STUArray s i Int
</span><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-var">coerceSTMI</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679065246"><span class="annot"><span class="annottext">unsafeNewArray_ :: (i, i) -&gt; ST s (STUArray s i MInt)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeNewArray_</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(STUArray s i Int -&gt; STUArray s i MInt)
-&gt; ST s (STUArray s i Int) -&gt; ST s (STUArray s i MInt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; STUArray s i MInt
forall s i. STUArray s i Int -&gt; STUArray s i MInt
</span><a href="MInt.html#coerceSTIM"><span class="hs-identifier hs-var">coerceSTIM</span></a></span><span> </span><span class="annot"><span class="annottext">(ST s (STUArray s i Int) -&gt; ST s (STUArray s i MInt))
-&gt; ((i, i) -&gt; ST s (STUArray s i Int))
-&gt; (i, i)
-&gt; ST s (STUArray s i MInt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (STUArray s i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><span class="hs-identifier hs-var">unsafeNewArray_</span></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679065244"><span class="annot"><span class="annottext">newArray_ :: (i, i) -&gt; ST s (STUArray s i MInt)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">newArray_</span></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(STUArray s i Int -&gt; STUArray s i MInt)
-&gt; ST s (STUArray s i Int) -&gt; ST s (STUArray s i MInt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; STUArray s i MInt
forall s i. STUArray s i Int -&gt; STUArray s i MInt
</span><a href="MInt.html#coerceSTIM"><span class="hs-identifier hs-var">coerceSTIM</span></a></span><span> </span><span class="annot"><span class="annottext">(ST s (STUArray s i Int) -&gt; ST s (STUArray s i MInt))
-&gt; ((i, i) -&gt; ST s (STUArray s i Int))
-&gt; (i, i)
-&gt; ST s (STUArray s i MInt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; ST s (STUArray s i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><span class="hs-identifier hs-var">newArray_</span></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679065242"><span class="annot"><span class="annottext">unsafeRead :: STUArray s i MInt -&gt; Int -&gt; ST s MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeRead</span></span></span><span> </span><span id="local-6989586621679065240"><span class="annot"><span class="annottext">STUArray s i MInt
</span><a href="#local-6989586621679065240"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065239"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065239"><span class="hs-identifier hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; ST s Int -&gt; ST s MInt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; Int -&gt; ST s Int
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; Int -&gt; m e
</span><span class="hs-identifier hs-var">unsafeRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STUArray s i MInt -&gt; STUArray s i Int
forall s i. STUArray s i MInt -&gt; STUArray s i Int
</span><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-var">coerceSTMI</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s i MInt
</span><a href="#local-6989586621679065240"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065239"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679065237"><span class="annot"><span class="annottext">unsafeWrite :: STUArray s i MInt -&gt; Int -&gt; MInt -&gt; ST s ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeWrite</span></span></span><span> </span><span id="local-6989586621679065235"><span class="annot"><span class="annottext">STUArray s i MInt
</span><a href="#local-6989586621679065235"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065234"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065234"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679065233"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065233"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STUArray s i Int -&gt; Int -&gt; Int -&gt; ST s ()
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; Int -&gt; e -&gt; m ()
</span><span class="hs-identifier hs-var">unsafeWrite</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STUArray s i MInt -&gt; STUArray s i Int
forall s i. STUArray s i MInt -&gt; STUArray s i Int
</span><a href="MInt.html#coerceSTMI"><span class="hs-identifier hs-var">coerceSTMI</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s i MInt
</span><a href="#local-6989586621679065235"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065234"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065233"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621679065394"><span class="annot"><a href="MInt.html#coerceIOIM"><span class="hs-identifier hs-type">coerceIOIM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065394"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065394"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span>
</span><span id="line-105"></span><span id="coerceIOIM"><span class="annot"><span class="annottext">coerceIOIM :: IOUArray i Int -&gt; IOUArray i MInt
</span><a href="MInt.html#coerceIOIM"><span class="hs-identifier hs-var hs-var">coerceIOIM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IOUArray i MInt
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679065397"><span class="annot"><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-type">coerceIOMI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065397"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065397"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-108"></span><span id="coerceIOMI"><span class="annot"><span class="annottext">coerceIOMI :: IOUArray i MInt -&gt; IOUArray i Int
</span><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-var hs-var">coerceIOMI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i MInt -&gt; IOUArray i Int
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOUArray</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679065222"><span class="annot"><span class="annottext">getBounds :: IOUArray i MInt -&gt; IO (i, i)
</span><a href="#local-6989586621679065222"><span class="hs-identifier hs-var hs-var hs-var hs-var">getBounds</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IO (i, i)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m (i, i)
</span><span class="hs-identifier hs-var">getBounds</span></span><span> </span><span class="annot"><span class="annottext">(IOUArray i Int -&gt; IO (i, i))
-&gt; (IOUArray i MInt -&gt; IOUArray i Int)
-&gt; IOUArray i MInt
-&gt; IO (i, i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IOUArray i MInt -&gt; IOUArray i Int
forall i. IOUArray i MInt -&gt; IOUArray i Int
</span><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-var">coerceIOMI</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679065221"><span class="annot"><span class="annottext">getNumElements :: IOUArray i MInt -&gt; IO Int
</span><a href="#local-6989586621679065221"><span class="hs-identifier hs-var hs-var hs-var hs-var">getNumElements</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IO Int
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; m Int
</span><span class="hs-identifier hs-var">getNumElements</span></span><span> </span><span class="annot"><span class="annottext">(IOUArray i Int -&gt; IO Int)
-&gt; (IOUArray i MInt -&gt; IOUArray i Int) -&gt; IOUArray i MInt -&gt; IO Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IOUArray i MInt -&gt; IOUArray i Int
forall i. IOUArray i MInt -&gt; IOUArray i Int
</span><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-var">coerceIOMI</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679065220"><span class="annot"><span class="annottext">newArray :: (i, i) -&gt; MInt -&gt; IO (IOUArray i MInt)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">newArray</span></span></span><span> </span><span id="local-6989586621679065218"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065218"><span class="hs-identifier hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679065217"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065217"><span class="hs-identifier hs-var">initialValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IOUArray i MInt
forall i. IOUArray i Int -&gt; IOUArray i MInt
</span><a href="MInt.html#coerceIOIM"><span class="hs-identifier hs-var">coerceIOIM</span></a></span><span> </span><span class="annot"><span class="annottext">(IOUArray i Int -&gt; IOUArray i MInt)
-&gt; IO (IOUArray i Int) -&gt; IO (IOUArray i MInt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; Int -&gt; IO (IOUArray i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><span class="hs-identifier hs-var">newArray</span></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679065218"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065217"><span class="hs-identifier hs-var">initialValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679065216"><span class="annot"><span class="annottext">unsafeNewArray_ :: (i, i) -&gt; IO (IOUArray i MInt)
</span><a href="#local-6989586621679065216"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeNewArray_</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IOUArray i Int -&gt; IOUArray i MInt)
-&gt; IO (IOUArray i Int) -&gt; IO (IOUArray i MInt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IOUArray i MInt
forall i. IOUArray i Int -&gt; IOUArray i MInt
</span><a href="MInt.html#coerceIOIM"><span class="hs-identifier hs-var">coerceIOIM</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (IOUArray i Int) -&gt; IO (IOUArray i MInt))
-&gt; ((i, i) -&gt; IO (IOUArray i Int))
-&gt; (i, i)
-&gt; IO (IOUArray i MInt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; IO (IOUArray i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><span class="hs-identifier hs-var">unsafeNewArray_</span></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679065215"><span class="annot"><span class="annottext">newArray_ :: (i, i) -&gt; IO (IOUArray i MInt)
</span><a href="#local-6989586621679065215"><span class="hs-identifier hs-var hs-var hs-var hs-var">newArray_</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IOUArray i Int -&gt; IOUArray i MInt)
-&gt; IO (IOUArray i Int) -&gt; IO (IOUArray i MInt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; IOUArray i MInt
forall i. IOUArray i Int -&gt; IOUArray i MInt
</span><a href="MInt.html#coerceIOIM"><span class="hs-identifier hs-var">coerceIOIM</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (IOUArray i Int) -&gt; IO (IOUArray i MInt))
-&gt; ((i, i) -&gt; IO (IOUArray i Int))
-&gt; (i, i)
-&gt; IO (IOUArray i MInt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(i, i) -&gt; IO (IOUArray i Int)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><span class="hs-identifier hs-var">newArray_</span></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679065214"><span class="annot"><span class="annottext">unsafeRead :: IOUArray i MInt -&gt; Int -&gt; IO MInt
</span><a href="#local-6989586621679065214"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeRead</span></a></span></span><span> </span><span id="local-6989586621679065213"><span class="annot"><span class="annottext">IOUArray i MInt
</span><a href="#local-6989586621679065213"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065212"><span class="hs-identifier hs-var">i</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; IO Int -&gt; IO MInt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; Int -&gt; IO Int
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; Int -&gt; m e
</span><span class="hs-identifier hs-var">unsafeRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOUArray i MInt -&gt; IOUArray i Int
forall i. IOUArray i MInt -&gt; IOUArray i Int
</span><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-var">coerceIOMI</span></a></span><span> </span><span class="annot"><span class="annottext">IOUArray i MInt
</span><a href="#local-6989586621679065213"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065212"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679065211"><span class="annot"><span class="annottext">unsafeWrite :: IOUArray i MInt -&gt; Int -&gt; MInt -&gt; IO ()
</span><a href="#local-6989586621679065211"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeWrite</span></a></span></span><span> </span><span id="local-6989586621679065210"><span class="annot"><span class="annottext">IOUArray i MInt
</span><a href="#local-6989586621679065210"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679065209"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065209"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679065208"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065208"><span class="hs-identifier hs-var">e</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOUArray i Int -&gt; Int -&gt; Int -&gt; IO ()
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; Int -&gt; e -&gt; m ()
</span><span class="hs-identifier hs-var">unsafeWrite</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOUArray i MInt -&gt; IOUArray i Int
forall i. IOUArray i MInt -&gt; IOUArray i Int
</span><a href="MInt.html#coerceIOMI"><span class="hs-identifier hs-var">coerceIOMI</span></a></span><span> </span><span class="annot"><span class="annottext">IOUArray i MInt
</span><a href="#local-6989586621679065210"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065209"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679065208"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span></pre></body></html>