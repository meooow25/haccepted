<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">{-|
== Modular arithmetic

MInt is a newtype of Int for arithmetic modulo a known fixed prime.
For a more general type see Mod.hs.

Instances of Eq, Num, Fractional exist for MInt. All the usual operations take O(1) time, except for
recip which takes O(log m) time.
An instance of Enum exists for MInt. The enum is cyclic, it wraps to 0 after m-1.
Unboxed array support is available via Unbox.

-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">{-
Implementation notes:
* MInt is a newtype of Int, change to Int64 if running on 32-bit.
-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MInt</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier">MInt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MInt.html#mm"><span class="hs-identifier">mm</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Array.html"><span class="hs-identifier">Array</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Array.html#Unbox"><span class="hs-identifier">Unbox</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | The prime modulus.</span><span>
</span><span id="line-31"></span><span class="annot"><a href="MInt.html#mm"><span class="hs-identifier hs-type">mm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-32"></span><span id="mm"><span class="annot"><span class="annottext">mm :: Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000007</span></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- m = 998244353</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Int type for arithmetic modulo a fixed prime mm.</span><span>
</span><span id="line-36"></span><span class="hs-keyword">newtype</span><span> </span><span id="MInt"><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MInt"><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unMInt"><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#unMInt"><span class="hs-identifier hs-var hs-var">unMInt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071945"><span id="local-6989586621679071947"><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
(MInt -&gt; MInt -&gt; Bool) -&gt; (MInt -&gt; MInt -&gt; Bool) -&gt; Eq MInt
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MInt -&gt; MInt -&gt; Bool
$c/= :: MInt -&gt; MInt -&gt; Bool
== :: MInt -&gt; MInt -&gt; Bool
$c== :: MInt -&gt; MInt -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071929"><span id="local-6989586621679071931"><span id="local-6989586621679071933"><span id="local-6989586621679071935"><span id="local-6989586621679071937"><span id="local-6989586621679071939"><span id="local-6989586621679071941"><span class="annot"><span class="annottext">Eq MInt
Eq MInt
-&gt; (MInt -&gt; MInt -&gt; Ordering)
-&gt; (MInt -&gt; MInt -&gt; Bool)
-&gt; (MInt -&gt; MInt -&gt; Bool)
-&gt; (MInt -&gt; MInt -&gt; Bool)
-&gt; (MInt -&gt; MInt -&gt; Bool)
-&gt; (MInt -&gt; MInt -&gt; MInt)
-&gt; (MInt -&gt; MInt -&gt; MInt)
-&gt; Ord MInt
MInt -&gt; MInt -&gt; Bool
MInt -&gt; MInt -&gt; Ordering
MInt -&gt; MInt -&gt; MInt
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: MInt -&gt; MInt -&gt; MInt
$cmin :: MInt -&gt; MInt -&gt; MInt
max :: MInt -&gt; MInt -&gt; MInt
$cmax :: MInt -&gt; MInt -&gt; MInt
&gt;= :: MInt -&gt; MInt -&gt; Bool
$c&gt;= :: MInt -&gt; MInt -&gt; Bool
&gt; :: MInt -&gt; MInt -&gt; Bool
$c&gt; :: MInt -&gt; MInt -&gt; Bool
&lt;= :: MInt -&gt; MInt -&gt; Bool
$c&lt;= :: MInt -&gt; MInt -&gt; Bool
&lt; :: MInt -&gt; MInt -&gt; Bool
$c&lt; :: MInt -&gt; MInt -&gt; Bool
compare :: MInt -&gt; MInt -&gt; Ordering
$ccompare :: MInt -&gt; MInt -&gt; Ordering
$cp1Ord :: Eq MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071922"><span id="local-6989586621679071924"><span id="local-6989586621679071926"><span class="annot"><span class="annottext">Int -&gt; MInt -&gt; ShowS
[MInt] -&gt; ShowS
MInt -&gt; String
(Int -&gt; MInt -&gt; ShowS)
-&gt; (MInt -&gt; String) -&gt; ([MInt] -&gt; ShowS) -&gt; Show MInt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MInt] -&gt; ShowS
$cshowList :: [MInt] -&gt; ShowS
show :: MInt -&gt; String
$cshow :: MInt -&gt; String
showsPrec :: Int -&gt; MInt -&gt; ShowS
$cshowsPrec :: Int -&gt; MInt -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071916"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071911"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071911"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679071910"><span class="annot"><span class="annottext">+ :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071908"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071908"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071907"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679071907"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071911"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071908"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071907"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071907"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071907"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071906"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071906"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679071905"><span class="annot"><span class="annottext">- :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071904"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071904"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071903"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679071903"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071906"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071904"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071903"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071903"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071903"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071901"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071901"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679071900"><span class="annot"><span class="annottext">* :: MInt -&gt; MInt -&gt; MInt
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span id="local-6989586621679071898"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071898"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; Int -&gt; MInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071901"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071898"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span id="local-6989586621679071896"><span class="annot"><span class="annottext">abs :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679071893"><span class="annot"><span class="annottext">signum :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; (MInt -&gt; Int) -&gt; MInt -&gt; MInt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (MInt -&gt; Int) -&gt; MInt -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#unMInt"><span class="hs-identifier hs-var hs-var">unMInt</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679071890"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
</span><a href="MInt.html#MInt"><span class="hs-identifier hs-var">MInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; MInt) -&gt; (Integer -&gt; Int) -&gt; Integer -&gt; MInt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; (Integer -&gt; Integer) -&gt; Integer -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071887"><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679071883"><span class="annot"><span class="annottext">recip :: MInt -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; Int -&gt; MInt
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="MInt.html#mm"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679071880"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span id="local-6989586621679071879"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679071879"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679071879"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679071879"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071866"><span id="local-6989586621679071868"><span id="local-6989586621679071872"><span id="local-6989586621679071874"><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679071862"><span class="annot"><span class="annottext">toEnum :: Int -&gt; MInt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEnum</span></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621679071860"><span class="annot"><span class="annottext">fromEnum :: MInt -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromEnum</span></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; Int
</span><a href="MInt.html#unMInt"><span class="hs-identifier hs-var hs-var">unMInt</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679071858"><span class="annot"><span class="annottext">enumFromTo :: MInt -&gt; MInt -&gt; [MInt]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromTo</span></span></span><span> </span><span id="local-6989586621679071857"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071857"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679071856"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071856"><span class="hs-identifier hs-var">y</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MInt -&gt; Bool) -&gt; [MInt] -&gt; [MInt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071856"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071857"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679071853"><span class="annot"><span class="annottext">enumFromThenTo :: MInt -&gt; MInt -&gt; MInt -&gt; [MInt]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromThenTo</span></span></span><span> </span><span id="local-6989586621679071852"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071852"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679071851"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071851"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679071850"><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071850"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MInt -&gt; Bool) -&gt; [MInt] -&gt; [MInt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071850"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">MInt -&gt; MInt -&gt; MInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">MInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071852"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MInt
</span><a href="#local-6989586621679071851"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071846"><span id="local-6989586621679071848"><span class="annot"><a href="Array.html#Unbox"><span class="hs-identifier hs-type">Unbox</span></a></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Unboxed"><span class="annot"><a href="Array.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- For tests</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="MInt.html#MInt"><span class="hs-identifier hs-type">MInt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679071842"><span class="annot"><span class="annottext">rnf :: MInt -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MInt -&gt; ()
forall a. a -&gt; ()
</span><span class="hs-identifier hs-var">rwhnf</span></span><span>
</span><span id="line-64"></span></pre></body></html>